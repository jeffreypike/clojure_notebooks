<!DOCTYPE html>
<html><head><title>Logistic Regression with Gradient Descent</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="In this notebook we train a logistic regression model from scratch on synthetic data using gradient descent." property="og:description"><meta content="Logistic Regression with Gradient Descent" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }
  
  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply py-4 pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.notebook-viewer { @apply py-16; }
#clerk-static-app .notebook-viewer { @apply pt-[0.8rem] pb-16; }
.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[205px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.result-viewer + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body><div id="clerk-static-app"></div><script type="module">let state = "{:out-path \"public/build\", :path->doc {\"notebooks/logistic_regression.clj\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:type :toc, :content [{:type :text, :text \"Logistic Regression with Gradient Descent\"}], :heading-level 1, :attrs {:id \"logistic-regression-with-gradient-descent\"}, :path [:content 0], :children [{:children [{:type :toc, :content [{:type :text, :text \"Setup\"}], :heading-level 3, :attrs {:id \"setup\"}, :path [:content 2]} {:type :toc, :content [{:type :text, :text \"Utility Functions\"}], :heading-level 3, :attrs {:id \"utility-functions\"}, :path [:content 3]} {:type :toc, :content [{:type :text, :text \"Regression Functions\"}], :heading-level 3, :attrs {:id \"regression-functions\"}, :path [:content 5]} {:type :toc, :content [{:type :text, :text \"Generate Random Data\"}], :heading-level 3, :attrs {:id \"generate-random-data\"}, :path [:content 7]} {:type :toc, :content [{:type :text, :text \"Initialize Random Parameters\"}], :heading-level 3, :attrs {:id \"initialize-random-parameters\"}, :path [:content 11]} {:type :toc, :content [{:type :text, :text \"Train the Model\"}], :heading-level 3, :attrs {:id \"train-the-model\"}, :path [:content 14]}], :type :toc}]}]}, :sidenotes? false, :toc-visibility false, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns logistic_regression), :auto-expand-results? nil, :scope logistic_regression, :bundle? false, :open-graph {:type \"article:clerk\", :title \"Logistic Regression with Gradient Descent\", :description \"In this notebook we train a logistic regression model from scratch on synthetic data using gradient descent.\"}, :title \"Logistic Regression with Gradient Descent\", :blocks [{:nextjournal/value [:div.markdown-viewer [\"h1\" {:id \"logistic-regression-with-gradient-descent\"} [:<> \"Logistic Regression with Gradient Descent\"]] [:p [:<> \"In this notebook we train a logistic regression model from scratch on\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"synthetic data using gradient descent.\"]] [\"h3\" {:id \"setup\"} [:<> \"Setup\"]]], :nextjournal/opts {:id \"startup/markdown-5ds5imVmbGnpCH6n6AZm5Wf3sc4oLi\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(ns logistic_regression\\n  (:require [nextjournal.clerk :as clerk]\\n            [uncomplicate.neanderthal\\n             [native :refer [dv dge]]\\n             [core :refer [subvector mv xpy entry ax trans sum col mrows]]\\n             [random :refer [rand-normal!]]\\n             [vect-math :refer [sigmoid]]]\\n            [tablecloth.api :as tc]))\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5dqohn85unkUQicpSEiBQyVQCH44gX-code\", :loc {:line 7, :end-line 14, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"utility-functions\"} [:<> \"Utility Functions\"]] [:p [:<> \"First let's define a quality of life function.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dsFidxWyqbdWVbrD6noz7byfZbtwc\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn ->vec\\n  \\\"For converting Neanderthal vectors into Clojure vectors\\\"\\n  [x]\\n  (into [] x))\", :nextjournal/opts {:id \"logistic_regression/->vec-code\", :loc {:line 19, :end-line 22, :column 1, :end-column 15}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/->vec]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/->vec-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"regression-functions\"} [:<> \"Regression Functions\"]] [:p [:<> \"Now let's get in to the real meat of the notebook: the functions that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"define and train the regression models.  We'll introduce the model itself,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"a helper function for plotting the decision boundary of a model, and a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"bare-bones gradient decscent algorithm.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtwWGE2K8utt5WPYzCYzLFTSejomn\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn logistic_regression\\n  \\\"The output of a logistic regression model\\\"\\n  [params X]\\n  (sigmoid (xpy (mv X (get params :weights))\\n       (ax (get params :bias) (dv (repeat (mrows X) 1))))))\", :nextjournal/opts {:id \"logistic_regression/logistic_regression-code\", :loc {:line 30, :end-line 34, :column 1, :end-column 60}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/logistic-regression]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/logistic_regression-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn decision_boundary\\n  \\\"The decision boundary line of a logistic regression model\\\"\\n  [params x]\\n  (xpy (ax (/ (* -1 (entry (get params :weights) 0))\\n              (entry (get params :weights) 1))\\n           x)\\n       (ax (/ (* -1 (get params :bias))\\n              (entry (get params :weights) 1))\\n           (dv (repeat 100 1)))))\", :nextjournal/opts {:id \"logistic_regression/decision_boundary-code\", :loc {:line 36, :end-line 44, :column 1, :end-column 34}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/decision-boundary]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/decision_boundary-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn step\\n  \\\"Perform one step of gradient descent\\\"\\n  [params X y learning_rate]\\n  {:weights (xpy (get params :weights)\\n                 (ax (* -1 learning_rate)\\n                     (mv (trans X)\\n                         (xpy (logistic_regression params X)\\n                              (ax -1 y)))))\\n   :bias (+ (get params :bias)\\n            (* (* -1 learning_rate)\\n               (sum (xpy (logistic_regression params X)\\n                         (ax -1 y)))))})\", :nextjournal/opts {:id \"logistic_regression/step-code\", :loc {:line 46, :end-line 57, :column 1, :end-column 41}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/step]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/step-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn train\\n  \\\"Train a linear regression model with gradient descent\\\"\\n  ([params X y learning_rate epochs count]\\n   (if (= epochs count)\\n     params\\n     (recur (step params X y learning_rate) X y learning_rate epochs (inc count))))\\n  ([params X y learning_rate epochs]\\n   (train params X y learning_rate epochs 0)))\", :nextjournal/opts {:id \"logistic_regression/train-code\", :loc {:line 59, :end-line 66, :column 1, :end-column 47}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/train]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/train-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"generate-random-data\"} [:<> \"Generate Random Data\"]] [:p [:<> \"First we generate some synthetic data.  For simplicity, we'll generate\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"two Gaussian clouds, one centred at the origin and the other centred\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"at (1,1).\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dqx5sC4ML3GTDy7ju46zH9u2Qqwca\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def xy (xpy (rand-normal! (dge 100 2)) \\n             (dge 100 2 (concat (repeat 50 0) (repeat 50 1) (repeat 50 0) (repeat 50 1)))))\", :nextjournal/opts {:id \"logistic_regression/xy-code\", :loc {:line 73, :end-line 74, :column 1, :end-column 92}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealGEMatrix[double, mxn:100x2, layout:column, offset:0]\\n   ▥       ↓       ↓       ┓    \\n   →       0.03    1.28         \\n   →      -1.17   -1.22         \\n   →       ⁙       ⁙            \\n   →      -0.35    0.11         \\n   →       0.02    1.55         \\n   ┗                       ┛    \\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5drkYu87rhcyWxhFTm4eLKfGwcNMwY\"}, :nextjournal/opts {:id \"logistic_regression/xy-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def labels (dv (concat (repeat 50 0) (repeat 50 1))))\", :nextjournal/opts {:id \"logistic_regression/labels-code\", :loc {:line 75, :end-line 75, :column 1, :end-column 55}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[   0.00    0.00    0.00    ⋯      1.00    1.00 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dsTsQaHPK4ZBZQPMTLNK7aP7SYMph\"}, :nextjournal/opts {:id \"logistic_regression/labels-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"For this notebook, creating an R-like (or pandas-like) dataframe\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"is completely unnecessary, but let's do it anyways!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtDxTnRU2bCNnhbF7c9LkSMsEbhxm\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/table (tc/dataset {:x (->vec (col xy 0)) \\n                          :y (->vec (col xy 1)) \\n                          :label (->vec labels)}))\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5dteqDPnAUFYvmuAWKJRiSgSSBA6K8-code\", :loc {:line 80, :end-line 82, :column 1, :end-column 51}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :x, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value :y, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 2], :nextjournal/value :label, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-head-viewer, :render-fn #viewer-fn (fn [header-row {:as opts, :keys [path number-col?]}] [:thead (into [:tr] (map-indexed (fn [i {:as header-cell, :nextjournal/keys [value]}] (let [title (when (or (string? value) (keyword? value) (symbol? value)) value)] [:th.pl-6.pr-2.py-1.align-bottom.font-medium.top-0.z-10.bg-white.dark:bg-slate-900.border-b.border-gray-300.dark:border-slate-700 (cond-> {:class (when (and (ifn? number-col?) (number-col? i)) \"text-right\")} title (assoc :title title)) [:div.flex.items-center (nextjournal.clerk.render/inspect-presented opts header-cell)]]))) header-row)]), :hash \"5dszDR5S2VhSEk6vkkHpb1FBgtPV99\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value 0.02509298218020463, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 1], :nextjournal/value 1.2753697588656918, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value -1.1671203138478665, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 1], :nextjournal/value -1.2199862625969116, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 2], :nextjournal/value [{:path [1 2 0], :nextjournal/value -0.17052629904180705, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 1], :nextjournal/value -0.03172105566547659, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 3], :nextjournal/value [{:path [1 3 0], :nextjournal/value 0.9807104091526556, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 1], :nextjournal/value -0.8300333348674396, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 4], :nextjournal/value [{:path [1 4 0], :nextjournal/value -2.1542759186523104, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 1], :nextjournal/value -0.48464175408017857, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 5], :nextjournal/value [{:path [1 5 0], :nextjournal/value -0.3223462795290649, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 1], :nextjournal/value -1.2067136067288469, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 6], :nextjournal/value [{:path [1 6 0], :nextjournal/value 0.8780563365651703, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 1], :nextjournal/value -1.170312742915519, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 7], :nextjournal/value [{:path [1 7 0], :nextjournal/value -0.2991716654317882, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 1], :nextjournal/value 0.521566741599308, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 8], :nextjournal/value [{:path [1 8 0], :nextjournal/value 0.1820634292673911, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 1], :nextjournal/value 0.686997490528568, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 9], :nextjournal/value [{:path [1 9 0], :nextjournal/value 0.43685238260373666, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 1], :nextjournal/value 0.6675722672115324, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 10], :nextjournal/value [{:path [1 10 0], :nextjournal/value 0.996922998582892, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 1], :nextjournal/value -0.83573052262572, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 11], :nextjournal/value [{:path [1 11 0], :nextjournal/value 2.528439090199254, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 1], :nextjournal/value 0.6793975559351707, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 12], :nextjournal/value [{:path [1 12 0], :nextjournal/value 0.8170175042173867, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 1], :nextjournal/value -0.1544953578364952, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 13], :nextjournal/value [{:path [1 13 0], :nextjournal/value 2.10868641110354, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 1], :nextjournal/value 0.9487858658884044, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 14], :nextjournal/value [{:path [1 14 0], :nextjournal/value 1.4442491636242367, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 1], :nextjournal/value 0.254699176392484, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 15], :nextjournal/value [{:path [1 15 0], :nextjournal/value -1.4170433358796495, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 1], :nextjournal/value -1.1406455722252244, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 16], :nextjournal/value [{:path [1 16 0], :nextjournal/value -1.049691955067629, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 1], :nextjournal/value 0.5528028831281577, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 17], :nextjournal/value [{:path [1 17 0], :nextjournal/value 0.5618705588341167, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 1], :nextjournal/value 0.3505467849224093, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 18], :nextjournal/value [{:path [1 18 0], :nextjournal/value 0.178590608417408, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 1], :nextjournal/value -0.358994320773931, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 19], :nextjournal/value [{:path [1 19 0], :nextjournal/value 0.28832255319568734, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 1], :nextjournal/value -0.893469266697601, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:nextjournal/value {:n 20, :path [1], :total 100, :offset 20}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn (fn [{:as fetch-opts, :keys [total offset unbounded?]} {:keys [num-cols]}] [nextjournal.clerk.render/consume-view-context :fetch-fn (fn [fetch-fn] [:tr.border-t.dark:border-slate-700 [:td.py-1.relative {:col-span num-cols, :class (if (fn? fetch-fn) \"bg-indigo-50 hover:bg-indigo-100 dark:bg-gray-800 dark:hover:bg-slate-700 cursor-pointer\" \"text-gray-400 text-slate-500\"), :on-click (fn [_] (when (fn? fetch-fn) (fetch-fn fetch-opts)))} [:span.sticky {:style {:left \"min(50vw, 50%)\"}, :class \"-translate-x-1/2\"} (- total offset) (when unbounded? \"+\") (if (fn? fetch-fn) \" more…\" \" more elided\")]]])]), :hash \"5drUHyj6Bew7ppqVaxrQbZrbNErYSX\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-body-viewer, :page-size 20, :render-fn #viewer-fn (fn [rows opts] (into [:tbody] (map-indexed (fn [idx row] (nextjournal.clerk.render/inspect-presented (update opts :path conj idx) row))) rows)), :hash \"5dt4ysvbhnCYY7GiXxiZuSL8MN8TVv\"}}], :nextjournal/width :wide, :nextjournal/opts {:num-cols 3, :number-col? #{0 1 2}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/table-markup-viewer, :render-fn #viewer-fn (fn [head+body opts] [:div (into [nextjournal.clerk.render/render-table-with-sticky-header] (nextjournal.clerk.render/inspect-children opts) head+body)]), :hash \"5dr1LyqxYnX13V68FDhw2cWLsZEBsm\"}}, :nextjournal/blob-id \"5dtqK9p856zzcaLxotM4xVodKqiNwG\"}, :nextjournal/width :wide, :nextjournal/opts {:id \"logistic_regression/anon-expr-5dteqDPnAUFYvmuAWKJRiSgSSBA6K8-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"And to cap this section off, let's plot the data we created\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtsBYUniH2x1xRVRpTVPy1BeNyzFX\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5drQAgVFMGif8FcTc3r6oAausXsZcE-code\", :loc {:line 86, :end-line 95, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.02509298218020463 -1.1671203138478665 -0.17052629904180705 0.9807104091526556 -2.1542759186523104 -0.3223462795290649 0.8780563365651703 -0.2991716654317882 0.1820634292673911 0.43685238260373666 0.996922998582892 2.528439090199254 0.8170175042173867 2.10868641110354 1.4442491636242367 -1.4170433358796495 -1.049691955067629 0.5618705588341167 0.178590608417408 0.28832255319568734 0.5125567546193258 0.4510330914505271 -1.3782415053431578 0.5868960524310372 0.02248930034122721 0.064358712465819 -0.6560507442313293 1.0483670321526668 -1.885632172450834 0.1876271521728945 0.236850942219579 0.200192756077831 -0.9017734288654431 0.8055531168036866 -0.8513748249014714 0.048302590899259736 0.38523905598294983 1.013170820448336 -0.0735092712690114 1.288714220927235 2.88669908462553 0.9448971756005351 -0.6550242953837528 -0.3522116555712615 -0.23245016116033923 -0.1403994114214979 0.47105049980817865 -1.2980727105216723 -0.35466138279862924 0.26261914209740433], :y [1.2753697588656918 -1.2199862625969116 -0.03172105566547659 -0.8300333348674396 -0.48464175408017857 -1.2067136067288469 -1.170312742915519 0.521566741599308 0.686997490528568 0.6675722672115324 -0.83573052262572 0.6793975559351707 -0.1544953578364952 0.9487858658884044 0.254699176392484 -1.1406455722252244 0.5528028831281577 0.3505467849224093 -0.358994320773931 -0.893469266697601 -0.15204010086225456 -0.9309191767587035 0.03468357025578293 0.21077235238601846 0.13654369246016532 0.1341051461212723 -0.09264864472099728 -1.5955497370545304 -0.6236710401663311 -0.8096501864852027 1.0403684895668552 -0.6846968237597767 -0.32080176924862325 0.713052208982913 0.0671285971320964 -0.9809705375474326 -2.0101377827231874 1.3231909814000247 0.32995275917465894 0.7041611694492335 -0.9639194679737791 0.09188051821664941 0.8950717783294897 0.9339629277096677 -0.44539534726028635 -0.10891870609213236 -1.627537496377078 -0.10142973050188712 2.2598008244578827 1.6814959139345291], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [1.5410003817237699 1.1267131830255261 -0.18108877666023426 1.716075393728634 0.3486842165803483 -1.0959869630078054 0.2625104081677382 1.7698308298527377 2.6259304045245475 0.2626872534535588 3.1796125912201068 1.0670223418277174 0.5171394432676674 1.4705587416863466 -1.2216016938019871 1.9904460461306037 0.8853933842754234 -0.5596782244812841 1.8786088041520057 1.059503614318191 0.9513738029595772 0.342122905570315 1.5861301467503202 2.8522499069395604 -0.30474357344857284 2.255038279948086 1.5787185835947293 0.9832152286544794 0.975891236058706 0.9372493385791997 1.8870536167647425 1.3015539561075167 0.7322282191609477 -0.12018122803229137 1.25071655982862 -0.21098525522350653 0.867909038003081 0.2916774500742273 0.1505191774002108 0.8095351760111376 -0.5825459979794501 1.8719108506930344 0.3681397428498159 1.8187725392563108 2.2792820510186775 1.45341920472085 1.211352149070617 1.1438363917061167 -0.353333693407444 0.017621428974765263], :y [1.355990424652046 2.5443543889999614 1.4471334291997773 2.171715014836256 0.8119302776420827 0.6903590055106212 0.8370245347554931 0.9962576066609471 2.2185403063563154 2.707075900431879 -0.2782559826177826 0.917977005568842 0.26884118059405915 -0.6454449168188334 1.1771483784450312 0.35347080614558857 1.995532430709134 0.40962210084170647 1.0216613283399976 -0.2093921554596878 2.0960025926529955 1.7317346198118622 2.1863498348141963 1.0701700470926607 2.131672516382635 1.8501545151371488 -0.49798907377198764 0.8690869515423341 0.4881806266664518 2.1997392814549803 1.1382266042662417 0.5298966846934745 2.3289582567037366 -0.04112266601123582 0.8941052606949985 0.21949623945113994 2.0001754156150486 0.36722246402039194 1.035773281660296 1.501770015432537 0.7244348805196641 2.598466498890196 0.32345034040777254 -1.5007976475445224 0.3058693312978177 0.7889814902138781 0.819658346591299 0.5598732328261605 0.11159585535660266 1.549627538620237], :name \"Class 1\", :type \"scatter\", :mode \"markers\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5dqpidKN3bmwuwtH9sdWN6sFVB8R67\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5drQAgVFMGif8FcTc3r6oAausXsZcE-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"initialize-random-parameters\"} [:<> \"Initialize Random Parameters\"]] [:p [:<> \"Since we're using gradient descent, let's start our model off by\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"initializing some random parameters... this should produce a terrible\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"model, but hey, you never know!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dr2ya3YakzXyycfuaaYn24Y8n8ZFe\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_init\\n  {:weights (rand-normal! (dv 2))\\n   :bias (entry (rand-normal! (dv 1)) 0)})\", :nextjournal/opts {:id \"logistic_regression/params_init-code\", :loc {:line 102, :end-line 104, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value -1.2592820090940569, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[  -0.66   -1.88 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dscf62zwUa2EJtk6Mc7ivGPE31eeU\"}, :nextjournal/opts {:id \"logistic_regression/params_init-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Let's take a look at just how bad this model is:\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dreWd14dqxfJ5fYJsdpBXNcis4pQW\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (col xy 0))\\n                       :y (->vec (decision_boundary params_init (col xy 0)))\\n                       :name \\\"Decision Boundary\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5duK794w2kmXeoyGJskenywSCM5th8-code\", :loc {:line 107, :end-line 119, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.02509298218020463 -1.1671203138478665 -0.17052629904180705 0.9807104091526556 -2.1542759186523104 -0.3223462795290649 0.8780563365651703 -0.2991716654317882 0.1820634292673911 0.43685238260373666 0.996922998582892 2.528439090199254 0.8170175042173867 2.10868641110354 1.4442491636242367 -1.4170433358796495 -1.049691955067629 0.5618705588341167 0.178590608417408 0.28832255319568734 0.5125567546193258 0.4510330914505271 -1.3782415053431578 0.5868960524310372 0.02248930034122721 0.064358712465819 -0.6560507442313293 1.0483670321526668 -1.885632172450834 0.1876271521728945 0.236850942219579 0.200192756077831 -0.9017734288654431 0.8055531168036866 -0.8513748249014714 0.048302590899259736 0.38523905598294983 1.013170820448336 -0.0735092712690114 1.288714220927235 2.88669908462553 0.9448971756005351 -0.6550242953837528 -0.3522116555712615 -0.23245016116033923 -0.1403994114214979 0.47105049980817865 -1.2980727105216723 -0.35466138279862924 0.26261914209740433], :y [1.2753697588656918 -1.2199862625969116 -0.03172105566547659 -0.8300333348674396 -0.48464175408017857 -1.2067136067288469 -1.170312742915519 0.521566741599308 0.686997490528568 0.6675722672115324 -0.83573052262572 0.6793975559351707 -0.1544953578364952 0.9487858658884044 0.254699176392484 -1.1406455722252244 0.5528028831281577 0.3505467849224093 -0.358994320773931 -0.893469266697601 -0.15204010086225456 -0.9309191767587035 0.03468357025578293 0.21077235238601846 0.13654369246016532 0.1341051461212723 -0.09264864472099728 -1.5955497370545304 -0.6236710401663311 -0.8096501864852027 1.0403684895668552 -0.6846968237597767 -0.32080176924862325 0.713052208982913 0.0671285971320964 -0.9809705375474326 -2.0101377827231874 1.3231909814000247 0.32995275917465894 0.7041611694492335 -0.9639194679737791 0.09188051821664941 0.8950717783294897 0.9339629277096677 -0.44539534726028635 -0.10891870609213236 -1.627537496377078 -0.10142973050188712 2.2598008244578827 1.6814959139345291], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [1.5410003817237699 1.1267131830255261 -0.18108877666023426 1.716075393728634 0.3486842165803483 -1.0959869630078054 0.2625104081677382 1.7698308298527377 2.6259304045245475 0.2626872534535588 3.1796125912201068 1.0670223418277174 0.5171394432676674 1.4705587416863466 -1.2216016938019871 1.9904460461306037 0.8853933842754234 -0.5596782244812841 1.8786088041520057 1.059503614318191 0.9513738029595772 0.342122905570315 1.5861301467503202 2.8522499069395604 -0.30474357344857284 2.255038279948086 1.5787185835947293 0.9832152286544794 0.975891236058706 0.9372493385791997 1.8870536167647425 1.3015539561075167 0.7322282191609477 -0.12018122803229137 1.25071655982862 -0.21098525522350653 0.867909038003081 0.2916774500742273 0.1505191774002108 0.8095351760111376 -0.5825459979794501 1.8719108506930344 0.3681397428498159 1.8187725392563108 2.2792820510186775 1.45341920472085 1.211352149070617 1.1438363917061167 -0.353333693407444 0.017621428974765263], :y [1.355990424652046 2.5443543889999614 1.4471334291997773 2.171715014836256 0.8119302776420827 0.6903590055106212 0.8370245347554931 0.9962576066609471 2.2185403063563154 2.707075900431879 -0.2782559826177826 0.917977005568842 0.26884118059405915 -0.6454449168188334 1.1771483784450312 0.35347080614558857 1.995532430709134 0.40962210084170647 1.0216613283399976 -0.2093921554596878 2.0960025926529955 1.7317346198118622 2.1863498348141963 1.0701700470926607 2.131672516382635 1.8501545151371488 -0.49798907377198764 0.8690869515423341 0.4881806266664518 2.1997392814549803 1.1382266042662417 0.5298966846934745 2.3289582567037366 -0.04112266601123582 0.8941052606949985 0.21949623945113994 2.0001754156150486 0.36722246402039194 1.035773281660296 1.501770015432537 0.7244348805196641 2.598466498890196 0.32345034040777254 -1.5007976475445224 0.3058693312978177 0.7889814902138781 0.819658346591299 0.5598732328261605 0.11159585535660266 1.549627538620237], :name \"Class 1\", :type \"scatter\", :mode \"markers\"} {:x [0.02509298218020463 -1.1671203138478665 -0.17052629904180705 0.9807104091526556 -2.1542759186523104 -0.3223462795290649 0.8780563365651703 -0.2991716654317882 0.1820634292673911 0.43685238260373666 0.996922998582892 2.528439090199254 0.8170175042173867 2.10868641110354 1.4442491636242367 -1.4170433358796495 -1.049691955067629 0.5618705588341167 0.178590608417408 0.28832255319568734 0.5125567546193258 0.4510330914505271 -1.3782415053431578 0.5868960524310372 0.02248930034122721 0.064358712465819 -0.6560507442313293 1.0483670321526668 -1.885632172450834 0.1876271521728945 0.236850942219579 0.200192756077831 -0.9017734288654431 0.8055531168036866 -0.8513748249014714 0.048302590899259736 0.38523905598294983 1.013170820448336 -0.0735092712690114 1.288714220927235 2.88669908462553 0.9448971756005351 -0.6550242953837528 -0.3522116555712615 -0.23245016116033923 -0.1403994114214979 0.47105049980817865 -1.2980727105216723 -0.35466138279862924 0.26261914209740433 1.5410003817237699 1.1267131830255261 -0.18108877666023426 1.716075393728634 0.3486842165803483 -1.0959869630078054 0.2625104081677382 1.7698308298527377 2.6259304045245475 0.2626872534535588 3.1796125912201068 1.0670223418277174 0.5171394432676674 1.4705587416863466 -1.2216016938019871 1.9904460461306037 0.8853933842754234 -0.5596782244812841 1.8786088041520057 1.059503614318191 0.9513738029595772 0.342122905570315 1.5861301467503202 2.8522499069395604 -0.30474357344857284 2.255038279948086 1.5787185835947293 0.9832152286544794 0.975891236058706 0.9372493385791997 1.8870536167647425 1.3015539561075167 0.7322282191609477 -0.12018122803229137 1.25071655982862 -0.21098525522350653 0.867909038003081 0.2916774500742273 0.1505191774002108 0.8095351760111376 -0.5825459979794501 1.8719108506930344 0.3681397428498159 1.8187725392563108 2.2792820510186775 1.45341920472085 1.211352149070617 1.1438363917061167 -0.353333693407444 0.017621428974765263], :y [-0.6770003258142702 -0.2570839392011168 -0.6081001197888247 -1.0135839038163916 0.09060788404511888 -0.5546267204950228 -0.9774275152107019 -0.5627891862595831 -0.7322878009376398 -0.822028501691766 -1.019294234336835 -1.558718434162484 -0.9559286726730793 -1.410874899063281 -1.1768495874665805 -0.16905709644348088 -0.29844406516950667 -0.8660618814557102 -0.7310646184856926 -0.7697139456663585 -0.8486927793453644 -0.8270231717213621 -0.1827237150990036 -0.8748762562655193 -0.6760832678739199 -0.690830337301471 -0.43709072799997506 -1.0374136369314835 -0.004012693973069026 -0.734247432176764 -0.7515848298728568 -0.7386732366908992 -0.3505433105334859 -0.951890734031116 -0.36829449627969824 -0.6851751172383219 -0.8038494714059177 -1.0250169742784223 -0.6422710520188416 -1.1220677197026505 -1.684903272755316 -1.0009699163057328 -0.4374522595250415 -0.5441076625091211 -0.5862895557625929 -0.6187112862902953 -0.834073619669652 -0.21096043310300822 -0.5432448298189211 -0.7606607975862442 -1.2109268973239105 -1.0650083908980637 -0.6043798480471918 -1.2725910866701144 -0.7909742785806876 -0.28213823087187573 -0.760622499775777 -1.2915246018164814 -1.5930564176206725 -0.7606847874835713 -1.788072044391366 -1.043984332172004 -0.8503068747967368 -1.1861162371424099 -0.23789473515159748 -1.3692287716658837 -0.980011739504427 -0.47103465430667424 -1.3298379255002761 -1.0413361173783526 -1.0032510869377913 -0.788663281026846 -1.2268223146303479 -1.6727697273034405 -0.560826672094757 -1.4624223429175196 -1.224211844817757 -1.0144661408773505 -1.0118865148015093 -0.9982762270991918 -1.3328123221202264 -1.1265900775893947 -0.9260645449007834 -0.6258324503814544 -1.10868434224709 -0.5938498352612488 -0.9738534761018669 -0.7708955934297157 -0.7211774163222264 -0.953293278289969 -0.46298026265609515 -1.3274788003138984 -0.7978268227671599 -1.3087626462468598 -1.4709613826847792 -1.1800794210334535 -1.0948195739361457 -1.071039455926722 -0.5437124630298142 -0.6743687265569321], :name \"Decision Boundary\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drxt3P6zDZK72Y81DU1kZz7JyjNop\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5duK794w2kmXeoyGJskenywSCM5th8-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"train-the-model\"} [:<> \"Train the Model\"]] [:p [:<> \"Now let's train the model! We'll use a learning rate of 0.0001 and train\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"for 1000 epochs.  I'm sure more efficient choices could have been made,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"but this will get the job done.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dskD6PtHqa5ytPCGwyNHZcFFZcvP8\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_optimal (train params_init xy labels 0.0001 1000))\", :nextjournal/opts {:id \"logistic_regression/params_optimal-code\", :loc {:line 126, :end-line 126, :column 1, :end-column 63}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value -0.5655860679604082, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[   0.63    0.76 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dspGwRWd4N9VsL6Z7AL3bjDwHNDwe\"}, :nextjournal/opts {:id \"logistic_regression/params_optimal-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Finally, let's admire our work!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5du9rgvGy9ssYrHcebKBcH4GSoZA8w\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (col xy 0))\\n                       :y (->vec (decision_boundary params_optimal (col xy 0)))\\n                       :name \\\"Decision Boundary\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5drT8bADNRzDLvzr9yMbU5SUaLSd55-code\", :loc {:line 130, :end-line 142, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.02509298218020463 -1.1671203138478665 -0.17052629904180705 0.9807104091526556 -2.1542759186523104 -0.3223462795290649 0.8780563365651703 -0.2991716654317882 0.1820634292673911 0.43685238260373666 0.996922998582892 2.528439090199254 0.8170175042173867 2.10868641110354 1.4442491636242367 -1.4170433358796495 -1.049691955067629 0.5618705588341167 0.178590608417408 0.28832255319568734 0.5125567546193258 0.4510330914505271 -1.3782415053431578 0.5868960524310372 0.02248930034122721 0.064358712465819 -0.6560507442313293 1.0483670321526668 -1.885632172450834 0.1876271521728945 0.236850942219579 0.200192756077831 -0.9017734288654431 0.8055531168036866 -0.8513748249014714 0.048302590899259736 0.38523905598294983 1.013170820448336 -0.0735092712690114 1.288714220927235 2.88669908462553 0.9448971756005351 -0.6550242953837528 -0.3522116555712615 -0.23245016116033923 -0.1403994114214979 0.47105049980817865 -1.2980727105216723 -0.35466138279862924 0.26261914209740433], :y [1.2753697588656918 -1.2199862625969116 -0.03172105566547659 -0.8300333348674396 -0.48464175408017857 -1.2067136067288469 -1.170312742915519 0.521566741599308 0.686997490528568 0.6675722672115324 -0.83573052262572 0.6793975559351707 -0.1544953578364952 0.9487858658884044 0.254699176392484 -1.1406455722252244 0.5528028831281577 0.3505467849224093 -0.358994320773931 -0.893469266697601 -0.15204010086225456 -0.9309191767587035 0.03468357025578293 0.21077235238601846 0.13654369246016532 0.1341051461212723 -0.09264864472099728 -1.5955497370545304 -0.6236710401663311 -0.8096501864852027 1.0403684895668552 -0.6846968237597767 -0.32080176924862325 0.713052208982913 0.0671285971320964 -0.9809705375474326 -2.0101377827231874 1.3231909814000247 0.32995275917465894 0.7041611694492335 -0.9639194679737791 0.09188051821664941 0.8950717783294897 0.9339629277096677 -0.44539534726028635 -0.10891870609213236 -1.627537496377078 -0.10142973050188712 2.2598008244578827 1.6814959139345291], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [1.5410003817237699 1.1267131830255261 -0.18108877666023426 1.716075393728634 0.3486842165803483 -1.0959869630078054 0.2625104081677382 1.7698308298527377 2.6259304045245475 0.2626872534535588 3.1796125912201068 1.0670223418277174 0.5171394432676674 1.4705587416863466 -1.2216016938019871 1.9904460461306037 0.8853933842754234 -0.5596782244812841 1.8786088041520057 1.059503614318191 0.9513738029595772 0.342122905570315 1.5861301467503202 2.8522499069395604 -0.30474357344857284 2.255038279948086 1.5787185835947293 0.9832152286544794 0.975891236058706 0.9372493385791997 1.8870536167647425 1.3015539561075167 0.7322282191609477 -0.12018122803229137 1.25071655982862 -0.21098525522350653 0.867909038003081 0.2916774500742273 0.1505191774002108 0.8095351760111376 -0.5825459979794501 1.8719108506930344 0.3681397428498159 1.8187725392563108 2.2792820510186775 1.45341920472085 1.211352149070617 1.1438363917061167 -0.353333693407444 0.017621428974765263], :y [1.355990424652046 2.5443543889999614 1.4471334291997773 2.171715014836256 0.8119302776420827 0.6903590055106212 0.8370245347554931 0.9962576066609471 2.2185403063563154 2.707075900431879 -0.2782559826177826 0.917977005568842 0.26884118059405915 -0.6454449168188334 1.1771483784450312 0.35347080614558857 1.995532430709134 0.40962210084170647 1.0216613283399976 -0.2093921554596878 2.0960025926529955 1.7317346198118622 2.1863498348141963 1.0701700470926607 2.131672516382635 1.8501545151371488 -0.49798907377198764 0.8690869515423341 0.4881806266664518 2.1997392814549803 1.1382266042662417 0.5298966846934745 2.3289582567037366 -0.04112266601123582 0.8941052606949985 0.21949623945113994 2.0001754156150486 0.36722246402039194 1.035773281660296 1.501770015432537 0.7244348805196641 2.598466498890196 0.32345034040777254 -1.5007976475445224 0.3058693312978177 0.7889814902138781 0.819658346591299 0.5598732328261605 0.11159585535660266 1.549627538620237], :name \"Class 1\", :type \"scatter\", :mode \"markers\"} {:x [0.02509298218020463 -1.1671203138478665 -0.17052629904180705 0.9807104091526556 -2.1542759186523104 -0.3223462795290649 0.8780563365651703 -0.2991716654317882 0.1820634292673911 0.43685238260373666 0.996922998582892 2.528439090199254 0.8170175042173867 2.10868641110354 1.4442491636242367 -1.4170433358796495 -1.049691955067629 0.5618705588341167 0.178590608417408 0.28832255319568734 0.5125567546193258 0.4510330914505271 -1.3782415053431578 0.5868960524310372 0.02248930034122721 0.064358712465819 -0.6560507442313293 1.0483670321526668 -1.885632172450834 0.1876271521728945 0.236850942219579 0.200192756077831 -0.9017734288654431 0.8055531168036866 -0.8513748249014714 0.048302590899259736 0.38523905598294983 1.013170820448336 -0.0735092712690114 1.288714220927235 2.88669908462553 0.9448971756005351 -0.6550242953837528 -0.3522116555712615 -0.23245016116033923 -0.1403994114214979 0.47105049980817865 -1.2980727105216723 -0.35466138279862924 0.26261914209740433 1.5410003817237699 1.1267131830255261 -0.18108877666023426 1.716075393728634 0.3486842165803483 -1.0959869630078054 0.2625104081677382 1.7698308298527377 2.6259304045245475 0.2626872534535588 3.1796125912201068 1.0670223418277174 0.5171394432676674 1.4705587416863466 -1.2216016938019871 1.9904460461306037 0.8853933842754234 -0.5596782244812841 1.8786088041520057 1.059503614318191 0.9513738029595772 0.342122905570315 1.5861301467503202 2.8522499069395604 -0.30474357344857284 2.255038279948086 1.5787185835947293 0.9832152286544794 0.975891236058706 0.9372493385791997 1.8870536167647425 1.3015539561075167 0.7322282191609477 -0.12018122803229137 1.25071655982862 -0.21098525522350653 0.867909038003081 0.2916774500742273 0.1505191774002108 0.8095351760111376 -0.5825459979794501 1.8719108506930344 0.3681397428498159 1.8187725392563108 2.2792820510186775 1.45341920472085 1.211352149070617 1.1438363917061167 -0.353333693407444 0.017621428974765263], :y [0.7242740922366833 1.7211612000312226 0.8878441011737974 -0.07477981540418199 2.5465862301791002 1.0147906649787712 0.011055933841361831 0.9954128622830154 0.5930208881940094 0.3799752665458787 -0.08833621629386657 -1.3689364681101184 0.06209447303989213 -1.0179539420413244 -0.4623747280220474 1.930138099915309 1.622971708815605 0.2754394351310971 0.5959247396646835 0.5041707209608748 0.3166739154223415 0.3681178532156884 1.8976933647747722 0.25451399165879296 0.7264512000299973 0.6914414603324129 1.2938226802930282 -0.13135191995152018 2.3219557147586665 0.5883686974708262 0.5472094838822793 0.5778617784688183 1.4992874047852833 0.0716805932832707 1.4571458528415924 0.7048670282607443 0.423132527138483 -0.10192207731501557 0.8067218518703744 -0.33232184260065156 -1.6685009595244877 -0.04483404065440677 1.2929643996259959 1.0397630490690095 0.939622671347836 0.8626530502379303 0.3513799956614378 1.8306590192669507 1.0418114253945479 0.5256630153645585 -0.5432747165628322 -0.19686223426413663 0.8966760759548692 -0.689666325301034 0.45369840679219825 1.6616819771246085 0.5257539348778916 -0.7346147430250467 -1.4504552992593913 0.5256060630280337 -1.9134250007139673 -0.14695083817272314 0.3128420312722586 -0.4843738780642508 1.7667166266248209 -0.9190854796150623 0.004920950868103291 1.21323934608214 -0.825571084941563 -0.14066394089835277 -0.05024957018903664 0.4591847458373372 -0.5810106494555867 -1.63969576063627 1.0000718971103026 -1.140328261920852 -0.574813359270157 -0.07687425796495495 -0.07075019122233972 -0.03843918651674283 -0.8326323422261652 -0.34305798059824144 0.1329923110639114 0.8457473116164319 -0.3005495258501567 0.9216744668866544 0.01954075039993408 0.5013654733954108 0.6193970895970472 0.06835093448848317 1.2323605793884915 -0.8199704902542688 0.43743037541056073 -0.7755380906343994 -1.1606000563263605 -0.4700423960287836 -0.26763438078230806 -0.21118006315819926 1.0407012579088828 0.7305215440060251], :name \"Decision Boundary\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drQozJyXz8j8uMHgiZoBQE5jJQLq7\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5drT8bADNRzDLvzr9yMbU5SUaLSd55-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}}], :css-class nil}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :index \"notebooks/logistic_regression.clj\", :browse? false, :paths [\"notebooks/logistic_regression.clj\"], :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true\"}, :current-path \"notebooks/logistic_regression.clj\", :bundle? false, :path->url {\"notebooks/logistic_regression.clj\" \"\"}, :expanded-paths [\"notebooks/logistic_regression.clj\"], :report-fn #function[nextjournal.clerk.builder/build-ui-reporter]}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
let opts = nextjournal.clerk.sci_env.read_string(state)
nextjournal.clerk.static_app.init(opts)
</script></body></html>