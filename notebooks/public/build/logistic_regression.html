<!DOCTYPE html>
<html><head><title>Logistic Regression with Gradient Descent</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="In this notebook we train a logistic regression model from scratch on synthetic data using gradient descent." property="og:description"><meta content="Logistic Regression with Gradient Descent" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }
  
  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply py-4 pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.notebook-viewer { @apply py-16; }
#clerk-static-app .notebook-viewer { @apply pt-[0.8rem] pb-16; }
.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[205px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.result-viewer + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body><div id="clerk-static-app"></div><script type="module">let state = "{:out-path \"public/build\", :path->doc {\"notebooks/logistic_regression.clj\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:type :toc, :content [{:type :text, :text \"Logistic Regression with Gradient Descent\"}], :heading-level 1, :attrs {:id \"logistic-regression-with-gradient-descent\"}, :path [:content 0], :children [{:children [{:type :toc, :content [{:type :text, :text \"Setup\"}], :heading-level 3, :attrs {:id \"setup\"}, :path [:content 2]} {:type :toc, :content [{:type :text, :text \"Utility Functions\"}], :heading-level 3, :attrs {:id \"utility-functions\"}, :path [:content 3]} {:type :toc, :content [{:type :text, :text \"Regression Functions\"}], :heading-level 3, :attrs {:id \"regression-functions\"}, :path [:content 5]} {:type :toc, :content [{:type :text, :text \"Generate Random Data\"}], :heading-level 3, :attrs {:id \"generate-random-data\"}, :path [:content 7]} {:type :toc, :content [{:type :text, :text \"Initialize Random Parameters\"}], :heading-level 3, :attrs {:id \"initialize-random-parameters\"}, :path [:content 11]} {:type :toc, :content [{:type :text, :text \"Train the Model\"}], :heading-level 3, :attrs {:id \"train-the-model\"}, :path [:content 14]}], :type :toc}]}]}, :sidenotes? false, :toc-visibility false, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns logistic_regression), :auto-expand-results? nil, :scope logistic_regression, :bundle? false, :open-graph {:type \"article:clerk\", :title \"Logistic Regression with Gradient Descent\", :description \"In this notebook we train a logistic regression model from scratch on synthetic data using gradient descent.\"}, :title \"Logistic Regression with Gradient Descent\", :blocks [{:nextjournal/value [:div.markdown-viewer [\"h1\" {:id \"logistic-regression-with-gradient-descent\"} [:<> \"Logistic Regression with Gradient Descent\"]] [:p [:<> \"In this notebook we train a logistic regression model from scratch on\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"synthetic data using gradient descent.\"]] [\"h3\" {:id \"setup\"} [:<> \"Setup\"]]], :nextjournal/opts {:id \"startup/markdown-5ds5imVmbGnpCH6n6AZm5Wf3sc4oLi\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(ns logistic_regression\\n  (:require [nextjournal.clerk :as clerk]\\n            [uncomplicate.neanderthal\\n             [native :refer [dv dge]]\\n             [core :refer [subvector mv xpy entry ax trans sum col mrows]]\\n             [random :refer [rand-normal!]]\\n             [vect-math :refer [sigmoid]]]\\n            [tablecloth.api :as tc]))\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5dqohn85unkUQicpSEiBQyVQCH44gX-code\", :loc {:line 7, :end-line 14, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"utility-functions\"} [:<> \"Utility Functions\"]] [:p [:<> \"First let's define a quality of life function.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dsFidxWyqbdWVbrD6noz7byfZbtwc\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn ->vec\\n  \\\"For converting Neanderthal vectors into Clojure vectors\\\"\\n  [x]\\n  (into [] x))\", :nextjournal/opts {:id \"logistic_regression/->vec-code\", :loc {:line 19, :end-line 22, :column 1, :end-column 15}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/->vec]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/->vec-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"regression-functions\"} [:<> \"Regression Functions\"]] [:p [:<> \"Now let's get in to the real meat of the notebook: the functions that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"define and train the regression models.  We'll introduce the model itself,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"a helper function for plotting the decision boundary of a model, and a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"bare-bones gradient decscent algorithm.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtwWGE2K8utt5WPYzCYzLFTSejomn\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn logistic_regression\\n  \\\"The output of a logistic regression model\\\"\\n  [params X]\\n  (sigmoid (xpy (mv X (get params :weights))\\n       (ax (get params :bias) (dv (repeat (mrows X) 1))))))\", :nextjournal/opts {:id \"logistic_regression/logistic_regression-code\", :loc {:line 30, :end-line 34, :column 1, :end-column 60}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/logistic-regression]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/logistic_regression-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn decision_boundary\\n  \\\"The decision boundary line of a logistic regression model\\\"\\n  [params x]\\n  (xpy (ax (/ (* -1 (entry (get params :weights) 0))\\n              (entry (get params :weights) 1))\\n           x)\\n       (ax (/ (* -1 (get params :bias))\\n              (entry (get params :weights) 1))\\n           (dv (repeat 100 1)))))\", :nextjournal/opts {:id \"logistic_regression/decision_boundary-code\", :loc {:line 36, :end-line 44, :column 1, :end-column 34}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/decision-boundary]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/decision_boundary-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn step\\n  \\\"Perform one step of gradient descent\\\"\\n  [params X y learning_rate]\\n  {:weights (xpy (get params :weights)\\n                 (ax (* -1 learning_rate)\\n                     (mv (trans X)\\n                         (xpy (logistic_regression params X)\\n                              (ax -1 y)))))\\n   :bias (+ (get params :bias)\\n            (* (* -1 learning_rate)\\n               (sum (xpy (logistic_regression params X)\\n                         (ax -1 y)))))})\", :nextjournal/opts {:id \"logistic_regression/step-code\", :loc {:line 46, :end-line 57, :column 1, :end-column 41}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/step]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/step-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn train\\n  \\\"Train a logistic regression model with gradient descent\\\"\\n  ([params X y learning_rate epochs count]\\n   (if (= epochs count)\\n     params\\n     (recur (step params X y learning_rate) X y learning_rate epochs (inc count))))\\n  ([params X y learning_rate epochs]\\n   (train params X y learning_rate epochs 0)))\", :nextjournal/opts {:id \"logistic_regression/train-code\", :loc {:line 59, :end-line 66, :column 1, :end-column 47}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[logistic-regression/train]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"logistic_regression/train-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"generate-random-data\"} [:<> \"Generate Random Data\"]] [:p [:<> \"First we generate some synthetic data.  For simplicity, we'll generate\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"two Gaussian clouds, one centred at the origin and the other centred\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"at (1,1).\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dqx5sC4ML3GTDy7ju46zH9u2Qqwca\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def xy (xpy (rand-normal! (dge 100 2)) \\n             (dge 100 2 (concat (repeat 50 0) (repeat 50 1) (repeat 50 0) (repeat 50 1)))))\", :nextjournal/opts {:id \"logistic_regression/xy-code\", :loc {:line 73, :end-line 74, :column 1, :end-column 92}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealGEMatrix[double, mxn:100x2, layout:column, offset:0]\\n   ▥       ↓       ↓       ┓    \\n   →       0.35    1.53         \\n   →       0.94   -0.98         \\n   →       ⁙       ⁙            \\n   →       1.59   -0.50         \\n   →       1.30    0.85         \\n   ┗                       ┛    \\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5drkYu87rhcyWxhFTm4eLKfGwcNMwY\"}, :nextjournal/opts {:id \"logistic_regression/xy-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def labels (dv (concat (repeat 50 0) (repeat 50 1))))\", :nextjournal/opts {:id \"logistic_regression/labels-code\", :loc {:line 75, :end-line 75, :column 1, :end-column 55}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[   0.00    0.00    0.00    ⋯      1.00    1.00 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dsTsQaHPK4ZBZQPMTLNK7aP7SYMph\"}, :nextjournal/opts {:id \"logistic_regression/labels-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"For this notebook, creating an R-like (or pandas-like) dataframe\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"is completely unnecessary, but let's do it anyways!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtDxTnRU2bCNnhbF7c9LkSMsEbhxm\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/table (tc/dataset {:x (->vec (col xy 0)) \\n                          :y (->vec (col xy 1)) \\n                          :label (->vec labels)}))\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5dteqDPnAUFYvmuAWKJRiSgSSBA6K8-code\", :loc {:line 80, :end-line 82, :column 1, :end-column 51}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :x, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value :y, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 2], :nextjournal/value :label, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-head-viewer, :render-fn #viewer-fn (fn [header-row {:as opts, :keys [path number-col?]}] [:thead (into [:tr] (map-indexed (fn [i {:as header-cell, :nextjournal/keys [value]}] (let [title (when (or (string? value) (keyword? value) (symbol? value)) value)] [:th.pl-6.pr-2.py-1.align-bottom.font-medium.top-0.z-10.bg-white.dark:bg-slate-900.border-b.border-gray-300.dark:border-slate-700 (cond-> {:class (when (and (ifn? number-col?) (number-col? i)) \"text-right\")} title (assoc :title title)) [:div.flex.items-center (nextjournal.clerk.render/inspect-presented opts header-cell)]]))) header-row)]), :hash \"5dszDR5S2VhSEk6vkkHpb1FBgtPV99\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value 0.349560034720641, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 1], :nextjournal/value 1.5279322154956858, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value 0.9357619282723991, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 1], :nextjournal/value -0.9769750153024188, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 2], :nextjournal/value [{:path [1 2 0], :nextjournal/value 1.4663901278004428, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 1], :nextjournal/value 1.7426724200508648, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 3], :nextjournal/value [{:path [1 3 0], :nextjournal/value -0.16827792917355475, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 1], :nextjournal/value -1.7531589345163758, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 4], :nextjournal/value [{:path [1 4 0], :nextjournal/value 0.5279626541216902, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 1], :nextjournal/value -1.3340892128239528, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 5], :nextjournal/value [{:path [1 5 0], :nextjournal/value -2.3270564031070013, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 1], :nextjournal/value 0.5613549332632132, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 6], :nextjournal/value [{:path [1 6 0], :nextjournal/value 0.6686393781146788, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 1], :nextjournal/value 0.7507329936675704, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 7], :nextjournal/value [{:path [1 7 0], :nextjournal/value -0.14143729400554567, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 1], :nextjournal/value -1.4020252424806212, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 8], :nextjournal/value [{:path [1 8 0], :nextjournal/value -0.5433855070875816, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 1], :nextjournal/value 0.9857350907136068, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 9], :nextjournal/value [{:path [1 9 0], :nextjournal/value 0.025710619339052124, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 1], :nextjournal/value 0.8426400641705073, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 10], :nextjournal/value [{:path [1 10 0], :nextjournal/value -0.9708498091335942, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 1], :nextjournal/value -0.9415323129003004, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 11], :nextjournal/value [{:path [1 11 0], :nextjournal/value -0.18938221419218101, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 1], :nextjournal/value -0.697178176011693, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 12], :nextjournal/value [{:path [1 12 0], :nextjournal/value -0.5433698420230062, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 1], :nextjournal/value -0.28807990941277845, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 13], :nextjournal/value [{:path [1 13 0], :nextjournal/value 1.7357746106261494, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 1], :nextjournal/value -0.6299472314358782, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 14], :nextjournal/value [{:path [1 14 0], :nextjournal/value -0.0951657535712722, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 1], :nextjournal/value -0.3771407300071892, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 15], :nextjournal/value [{:path [1 15 0], :nextjournal/value 2.720010923556669, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 1], :nextjournal/value 0.026162920686214224, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 16], :nextjournal/value [{:path [1 16 0], :nextjournal/value 0.5514773543221626, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 1], :nextjournal/value 0.3182990044461365, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 17], :nextjournal/value [{:path [1 17 0], :nextjournal/value 0.08731805950993865, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 1], :nextjournal/value 0.4237974718424872, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 18], :nextjournal/value [{:path [1 18 0], :nextjournal/value 2.183153985280867, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 1], :nextjournal/value -0.08389097918300657, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 19], :nextjournal/value [{:path [1 19 0], :nextjournal/value 0.8676074077366056, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 1], :nextjournal/value 0.9645269297137015, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 2], :nextjournal/value 0.0, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:nextjournal/value {:n 20, :path [1], :total 100, :offset 20}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn (fn [{:as fetch-opts, :keys [total offset unbounded?]} {:keys [num-cols]}] [nextjournal.clerk.render/consume-view-context :fetch-fn (fn [fetch-fn] [:tr.border-t.dark:border-slate-700 [:td.py-1.relative {:col-span num-cols, :class (if (fn? fetch-fn) \"bg-indigo-50 hover:bg-indigo-100 dark:bg-gray-800 dark:hover:bg-slate-700 cursor-pointer\" \"text-gray-400 text-slate-500\"), :on-click (fn [_] (when (fn? fetch-fn) (fetch-fn fetch-opts)))} [:span.sticky {:style {:left \"min(50vw, 50%)\"}, :class \"-translate-x-1/2\"} (- total offset) (when unbounded? \"+\") (if (fn? fetch-fn) \" more…\" \" more elided\")]]])]), :hash \"5drUHyj6Bew7ppqVaxrQbZrbNErYSX\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-body-viewer, :page-size 20, :render-fn #viewer-fn (fn [rows opts] (into [:tbody] (map-indexed (fn [idx row] (nextjournal.clerk.render/inspect-presented (update opts :path conj idx) row))) rows)), :hash \"5dt4ysvbhnCYY7GiXxiZuSL8MN8TVv\"}}], :nextjournal/width :wide, :nextjournal/opts {:num-cols 3, :number-col? #{0 1 2}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/table-markup-viewer, :render-fn #viewer-fn (fn [head+body opts] [:div (into [nextjournal.clerk.render/render-table-with-sticky-header] (nextjournal.clerk.render/inspect-children opts) head+body)]), :hash \"5dr1LyqxYnX13V68FDhw2cWLsZEBsm\"}}, :nextjournal/blob-id \"5dtqK9p856zzcaLxotM4xVodKqiNwG\"}, :nextjournal/width :wide, :nextjournal/opts {:id \"logistic_regression/anon-expr-5dteqDPnAUFYvmuAWKJRiSgSSBA6K8-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"And to cap this section off, let's plot the data we created\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dtsBYUniH2x1xRVRpTVPy1BeNyzFX\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5drQAgVFMGif8FcTc3r6oAausXsZcE-code\", :loc {:line 86, :end-line 95, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.349560034720641 0.9357619282723991 1.4663901278004428 -0.16827792917355475 0.5279626541216902 -2.3270564031070013 0.6686393781146788 -0.14143729400554567 -0.5433855070875816 0.025710619339052124 -0.9708498091335942 -0.18938221419218101 -0.5433698420230062 1.7357746106261494 -0.0951657535712722 2.720010923556669 0.5514773543221626 0.08731805950993865 2.183153985280867 0.8676074077366056 0.5374139565077989 -0.48491098652849096 -0.8116152701825693 2.2088339534134396 0.2166950728215243 -1.9237204742076957 -1.8290090782306698 0.9304828107517431 -0.6552735084527934 -0.14592697684959202 0.10429595445022612 0.5508288414840913 0.4894009053328757 -0.6511361797142053 0.5414526830425552 1.7805216022417776 1.169066373124237 1.89372209894508 0.45594211124449646 -0.8490239245990686 -0.03973527013152909 -0.18147002513063146 -0.8038221370742187 -0.48066299481789543 0.3003801761274062 1.352636008818893 0.7285176758560458 -1.3341206995531538 3.609798890289927 0.6632569044997341], :y [1.5279322154956858 -0.9769750153024188 1.7426724200508648 -1.7531589345163758 -1.3340892128239528 0.5613549332632132 0.7507329936675704 -1.4020252424806212 0.9857350907136068 0.8426400641705073 -0.9415323129003004 -0.697178176011693 -0.28807990941277845 -0.6299472314358782 -0.3771407300071892 0.026162920686214224 0.3182990044461365 0.4237974718424872 -0.08389097918300657 0.9645269297137015 2.2761538010193916 -0.09887885439717653 0.06197994419884624 0.6524622739741021 -1.011611939056672 -0.5159413943741198 0.5176714183994238 -0.610666479487612 0.9004585591202063 -0.9778726444753432 -1.0156141786310804 0.38450498746455924 -0.0961027522862129 -1.0469969794131235 0.8517336630370368 1.9844900393868943 0.8592380049955617 0.017188193474557526 0.625061603540197 -1.046134469490833 1.0177838697429749 -1.3753103249525018 0.9187807430860713 -0.7927650809847371 0.2775564840221165 0.742810642698219 -0.6023439502976703 1.179955556594991 -0.16260896578503092 -1.5611776209050565], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [0.9199853457965353 1.2165926669089484 -0.5852220660081506 1.4349768684908062 0.5647295596220372 0.7393633018726016 1.6147080237991678 2.696374094163395 1.2076056422885904 -0.25326594098612576 2.9718117713002323 -0.017312838268592312 0.21035706885573224 1.493293164886155 0.665553511971748 1.6111125668363022 0.3620316432794547 1.529465764798013 0.6691721928836668 0.2646365990944053 0.9926460345077271 -0.15243031518628336 1.7284448332300362 1.1570314657157081 2.891750876649942 2.172204001078428 0.8165031549727599 1.1509896752928728 -0.047189380699993455 -0.9525315963066621 2.712631569988106 -0.0489412475638169 1.6009452879102386 2.3341980105254114 2.609818290803452 0.34544485011244064 0.9429404733478447 1.267419252820873 -0.25918763952134327 -1.072409258829203 0.4274964289428721 2.1482517567496693 0.0670394918015157 1.0321529714526285 0.6588645353042365 2.254648001818121 1.9369070477053105 2.068878085022593 1.592234578306678 1.3020678764215246], :y [0.5142944511188816 3.190873293058793 1.1644144718830582 2.278542285798144 1.4822344073641283 0.2810064987985086 2.908591783281116 1.5270421307726934 0.7666465830538032 1.5382438819627575 0.8947361339178984 -0.13511791000690687 0.49745144906816785 0.34206505072732707 0.8421915697483491 1.7820045122350687 0.726240318827584 1.6690677425309233 0.2346659428462592 1.248463424556321 1.007157018209463 0.2602557074900146 1.5421016791342357 2.0230780311426377 2.3674992536657706 0.81404811380852 1.8678295893114947 1.4474317527899316 1.9606385208464208 1.8123604795647217 -0.022426860679804816 0.18291182275255824 0.6818242133207102 2.038352879411198 0.8802439782861964 -0.5530297551913892 0.1591430300733513 1.2465888026523877 0.6289184902086338 0.6283646417418098 -1.302076332470015 1.203374241294901 2.4481250422498047 1.099234388338458 1.284693085303855 1.6900611669673258 0.9821518321985526 1.2022237436313987 -0.5008354391779002 0.849839055331052], :name \"Class 1\", :type \"scatter\", :mode \"markers\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5dqpidKN3bmwuwtH9sdWN6sFVB8R67\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5drQAgVFMGif8FcTc3r6oAausXsZcE-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"initialize-random-parameters\"} [:<> \"Initialize Random Parameters\"]] [:p [:<> \"Since we're using gradient descent, let's start our model off by\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"initializing some random parameters... this should produce a terrible\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"model, but hey, you never know!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dr2ya3YakzXyycfuaaYn24Y8n8ZFe\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_init\\n  {:weights (rand-normal! (dv 2))\\n   :bias (entry (rand-normal! (dv 1)) 0)})\", :nextjournal/opts {:id \"logistic_regression/params_init-code\", :loc {:line 102, :end-line 104, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value 0.24021392796102778, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[   0.11   -1.32 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dscf62zwUa2EJtk6Mc7ivGPE31eeU\"}, :nextjournal/opts {:id \"logistic_regression/params_init-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Let's take a look at just how bad this model is:\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dreWd14dqxfJ5fYJsdpBXNcis4pQW\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (col xy 0))\\n                       :y (->vec (decision_boundary params_init (col xy 0)))\\n                       :name \\\"Decision Boundary\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5duK794w2kmXeoyGJskenywSCM5th8-code\", :loc {:line 107, :end-line 119, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.349560034720641 0.9357619282723991 1.4663901278004428 -0.16827792917355475 0.5279626541216902 -2.3270564031070013 0.6686393781146788 -0.14143729400554567 -0.5433855070875816 0.025710619339052124 -0.9708498091335942 -0.18938221419218101 -0.5433698420230062 1.7357746106261494 -0.0951657535712722 2.720010923556669 0.5514773543221626 0.08731805950993865 2.183153985280867 0.8676074077366056 0.5374139565077989 -0.48491098652849096 -0.8116152701825693 2.2088339534134396 0.2166950728215243 -1.9237204742076957 -1.8290090782306698 0.9304828107517431 -0.6552735084527934 -0.14592697684959202 0.10429595445022612 0.5508288414840913 0.4894009053328757 -0.6511361797142053 0.5414526830425552 1.7805216022417776 1.169066373124237 1.89372209894508 0.45594211124449646 -0.8490239245990686 -0.03973527013152909 -0.18147002513063146 -0.8038221370742187 -0.48066299481789543 0.3003801761274062 1.352636008818893 0.7285176758560458 -1.3341206995531538 3.609798890289927 0.6632569044997341], :y [1.5279322154956858 -0.9769750153024188 1.7426724200508648 -1.7531589345163758 -1.3340892128239528 0.5613549332632132 0.7507329936675704 -1.4020252424806212 0.9857350907136068 0.8426400641705073 -0.9415323129003004 -0.697178176011693 -0.28807990941277845 -0.6299472314358782 -0.3771407300071892 0.026162920686214224 0.3182990044461365 0.4237974718424872 -0.08389097918300657 0.9645269297137015 2.2761538010193916 -0.09887885439717653 0.06197994419884624 0.6524622739741021 -1.011611939056672 -0.5159413943741198 0.5176714183994238 -0.610666479487612 0.9004585591202063 -0.9778726444753432 -1.0156141786310804 0.38450498746455924 -0.0961027522862129 -1.0469969794131235 0.8517336630370368 1.9844900393868943 0.8592380049955617 0.017188193474557526 0.625061603540197 -1.046134469490833 1.0177838697429749 -1.3753103249525018 0.9187807430860713 -0.7927650809847371 0.2775564840221165 0.742810642698219 -0.6023439502976703 1.179955556594991 -0.16260896578503092 -1.5611776209050565], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [0.9199853457965353 1.2165926669089484 -0.5852220660081506 1.4349768684908062 0.5647295596220372 0.7393633018726016 1.6147080237991678 2.696374094163395 1.2076056422885904 -0.25326594098612576 2.9718117713002323 -0.017312838268592312 0.21035706885573224 1.493293164886155 0.665553511971748 1.6111125668363022 0.3620316432794547 1.529465764798013 0.6691721928836668 0.2646365990944053 0.9926460345077271 -0.15243031518628336 1.7284448332300362 1.1570314657157081 2.891750876649942 2.172204001078428 0.8165031549727599 1.1509896752928728 -0.047189380699993455 -0.9525315963066621 2.712631569988106 -0.0489412475638169 1.6009452879102386 2.3341980105254114 2.609818290803452 0.34544485011244064 0.9429404733478447 1.267419252820873 -0.25918763952134327 -1.072409258829203 0.4274964289428721 2.1482517567496693 0.0670394918015157 1.0321529714526285 0.6588645353042365 2.254648001818121 1.9369070477053105 2.068878085022593 1.592234578306678 1.3020678764215246], :y [0.5142944511188816 3.190873293058793 1.1644144718830582 2.278542285798144 1.4822344073641283 0.2810064987985086 2.908591783281116 1.5270421307726934 0.7666465830538032 1.5382438819627575 0.8947361339178984 -0.13511791000690687 0.49745144906816785 0.34206505072732707 0.8421915697483491 1.7820045122350687 0.726240318827584 1.6690677425309233 0.2346659428462592 1.248463424556321 1.007157018209463 0.2602557074900146 1.5421016791342357 2.0230780311426377 2.3674992536657706 0.81404811380852 1.8678295893114947 1.4474317527899316 1.9606385208464208 1.8123604795647217 -0.022426860679804816 0.18291182275255824 0.6818242133207102 2.038352879411198 0.8802439782861964 -0.5530297551913892 0.1591430300733513 1.2465888026523877 0.6289184902086338 0.6283646417418098 -1.302076332470015 1.203374241294901 2.4481250422498047 1.099234388338458 1.284693085303855 1.6900611669673258 0.9821518321985526 1.2022237436313987 -0.5008354391779002 0.849839055331052], :name \"Class 1\", :type \"scatter\", :mode \"markers\"} {:x [0.349560034720641 0.9357619282723991 1.4663901278004428 -0.16827792917355475 0.5279626541216902 -2.3270564031070013 0.6686393781146788 -0.14143729400554567 -0.5433855070875816 0.025710619339052124 -0.9708498091335942 -0.18938221419218101 -0.5433698420230062 1.7357746106261494 -0.0951657535712722 2.720010923556669 0.5514773543221626 0.08731805950993865 2.183153985280867 0.8676074077366056 0.5374139565077989 -0.48491098652849096 -0.8116152701825693 2.2088339534134396 0.2166950728215243 -1.9237204742076957 -1.8290090782306698 0.9304828107517431 -0.6552735084527934 -0.14592697684959202 0.10429595445022612 0.5508288414840913 0.4894009053328757 -0.6511361797142053 0.5414526830425552 1.7805216022417776 1.169066373124237 1.89372209894508 0.45594211124449646 -0.8490239245990686 -0.03973527013152909 -0.18147002513063146 -0.8038221370742187 -0.48066299481789543 0.3003801761274062 1.352636008818893 0.7285176758560458 -1.3341206995531538 3.609798890289927 0.6632569044997341 0.9199853457965353 1.2165926669089484 -0.5852220660081506 1.4349768684908062 0.5647295596220372 0.7393633018726016 1.6147080237991678 2.696374094163395 1.2076056422885904 -0.25326594098612576 2.9718117713002323 -0.017312838268592312 0.21035706885573224 1.493293164886155 0.665553511971748 1.6111125668363022 0.3620316432794547 1.529465764798013 0.6691721928836668 0.2646365990944053 0.9926460345077271 -0.15243031518628336 1.7284448332300362 1.1570314657157081 2.891750876649942 2.172204001078428 0.8165031549727599 1.1509896752928728 -0.047189380699993455 -0.9525315963066621 2.712631569988106 -0.0489412475638169 1.6009452879102386 2.3341980105254114 2.609818290803452 0.34544485011244064 0.9429404733478447 1.267419252820873 -0.25918763952134327 -1.072409258829203 0.4274964289428721 2.1482517567496693 0.0670394918015157 1.0321529714526285 0.6588645353042365 2.254648001818121 1.9369070477053105 2.068878085022593 1.592234578306678 1.3020678764215246], :y [0.21063045516622972 0.2580944168112495 0.3010586528316527 0.16870182694619973 0.22507547006257755 -0.006091499063117484 0.23646587105820435 0.1708750762859852 0.1383298819103455 0.18440881310140986 0.10371868488060462 0.1669930419939703 0.13833115028909412 0.3228703441640245 0.17462161931934445 0.40256260568764785 0.22697942301920654 0.1893970828587825 0.35909403725161704 0.25257603895503744 0.22584072902691105 0.14306448347263567 0.11661168664752324 0.3611733089767639 0.19987256181085813 0.026566056754969952 0.03423470831588976 0.25766697392122095 0.12927046421867025 0.17051155283672273 0.19077175967767926 0.22692691382602392 0.22195317826241373 0.12960545804028922 0.22616773916360464 0.3264934465748779 0.2769847570572804 0.3356591352101848 0.21924406569084331 0.11358275931387286 0.17910974937980556 0.16763368106777154 0.11724268592442447 0.14340843752300292 0.20664842960873175 0.29184813816137456 0.2413141345295921 0.07430514016283447 0.47460751442948323 0.23603005956727385 0.25681700861151335 0.2808328957448916 0.13494243323471244 0.29851516439973413 0.22805243586850676 0.24219228996192455 0.31306774902255735 0.4006487640981321 0.28010522871314764 0.1618204644372569 0.4229505742543661 0.18092526287035782 0.19935938234070044 0.3032369547689494 0.23621601271782558 0.3127766298138701 0.2116402641702584 0.3061658004681922 0.2365090123377487 0.20375432130234095 0.26270024471161 0.16998498646978888 0.3222768621623071 0.2760103071451882 0.41646815365022344 0.3582074320804035 0.2484381978464324 0.2755211116784878 0.17850620029200637 0.10520188539665011 0.40196510957138465 0.17836435403980835 0.3119533992131346 0.3713238643807637 0.3936404596623712 0.21029725432441335 0.2586756537398162 0.2849482545501219 0.16134099264564264 0.09549555582205599 0.21694085789062573 0.3562680517770679 0.1877551551022944 0.26589906709770567 0.23567441547038653 0.3648828095092642 0.33915576115790835 0.3498412746684987 0.3112481050285333 0.28775370598199934], :name \"Decision Boundary\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drxt3P6zDZK72Y81DU1kZz7JyjNop\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5duK794w2kmXeoyGJskenywSCM5th8-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"train-the-model\"} [:<> \"Train the Model\"]] [:p [:<> \"Now let's train the model! We'll use a learning rate of 0.0001 and train\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"for 1000 epochs.  I'm sure more efficient choices could have been made,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"but this will get the job done.\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5dskD6PtHqa5ytPCGwyNHZcFFZcvP8\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_optimal (train params_init xy labels 0.0001 1000))\", :nextjournal/opts {:id \"logistic_regression/params_optimal-code\", :loc {:line 126, :end-line 126, :column 1, :end-column 63}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value -0.3607422632716151, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[   0.41    0.59 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dsowQZFzB3q8rmPCbz6q7b6uV3n6R\"}, :nextjournal/opts {:id \"logistic_regression/params_optimal-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Finally, let's admire our work!\"]]], :nextjournal/opts {:id \"logistic_regression/markdown-5du9rgvGy9ssYrHcebKBcH4GSoZA8w\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec (subvector (col xy 0) 0 50))\\n                       :y (->vec (subvector (col xy 1) 0 50))\\n                       :name \\\"Class 0\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (subvector (col xy 0) 50 50))\\n                       :y (->vec (subvector (col xy 1) 50 50))\\n                       :name \\\"Class 1\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec (col xy 0))\\n                       :y (->vec (decision_boundary params_optimal (col xy 0)))\\n                       :name \\\"Decision Boundary\\\"}]})\", :nextjournal/opts {:id \"logistic_regression/anon-expr-5drT8bADNRzDLvzr9yMbU5SUaLSd55-code\", :loc {:line 130, :end-line 142, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [0.349560034720641 0.9357619282723991 1.4663901278004428 -0.16827792917355475 0.5279626541216902 -2.3270564031070013 0.6686393781146788 -0.14143729400554567 -0.5433855070875816 0.025710619339052124 -0.9708498091335942 -0.18938221419218101 -0.5433698420230062 1.7357746106261494 -0.0951657535712722 2.720010923556669 0.5514773543221626 0.08731805950993865 2.183153985280867 0.8676074077366056 0.5374139565077989 -0.48491098652849096 -0.8116152701825693 2.2088339534134396 0.2166950728215243 -1.9237204742076957 -1.8290090782306698 0.9304828107517431 -0.6552735084527934 -0.14592697684959202 0.10429595445022612 0.5508288414840913 0.4894009053328757 -0.6511361797142053 0.5414526830425552 1.7805216022417776 1.169066373124237 1.89372209894508 0.45594211124449646 -0.8490239245990686 -0.03973527013152909 -0.18147002513063146 -0.8038221370742187 -0.48066299481789543 0.3003801761274062 1.352636008818893 0.7285176758560458 -1.3341206995531538 3.609798890289927 0.6632569044997341], :y [1.5279322154956858 -0.9769750153024188 1.7426724200508648 -1.7531589345163758 -1.3340892128239528 0.5613549332632132 0.7507329936675704 -1.4020252424806212 0.9857350907136068 0.8426400641705073 -0.9415323129003004 -0.697178176011693 -0.28807990941277845 -0.6299472314358782 -0.3771407300071892 0.026162920686214224 0.3182990044461365 0.4237974718424872 -0.08389097918300657 0.9645269297137015 2.2761538010193916 -0.09887885439717653 0.06197994419884624 0.6524622739741021 -1.011611939056672 -0.5159413943741198 0.5176714183994238 -0.610666479487612 0.9004585591202063 -0.9778726444753432 -1.0156141786310804 0.38450498746455924 -0.0961027522862129 -1.0469969794131235 0.8517336630370368 1.9844900393868943 0.8592380049955617 0.017188193474557526 0.625061603540197 -1.046134469490833 1.0177838697429749 -1.3753103249525018 0.9187807430860713 -0.7927650809847371 0.2775564840221165 0.742810642698219 -0.6023439502976703 1.179955556594991 -0.16260896578503092 -1.5611776209050565], :name \"Class 0\", :type \"scatter\", :mode \"markers\"} {:x [0.9199853457965353 1.2165926669089484 -0.5852220660081506 1.4349768684908062 0.5647295596220372 0.7393633018726016 1.6147080237991678 2.696374094163395 1.2076056422885904 -0.25326594098612576 2.9718117713002323 -0.017312838268592312 0.21035706885573224 1.493293164886155 0.665553511971748 1.6111125668363022 0.3620316432794547 1.529465764798013 0.6691721928836668 0.2646365990944053 0.9926460345077271 -0.15243031518628336 1.7284448332300362 1.1570314657157081 2.891750876649942 2.172204001078428 0.8165031549727599 1.1509896752928728 -0.047189380699993455 -0.9525315963066621 2.712631569988106 -0.0489412475638169 1.6009452879102386 2.3341980105254114 2.609818290803452 0.34544485011244064 0.9429404733478447 1.267419252820873 -0.25918763952134327 -1.072409258829203 0.4274964289428721 2.1482517567496693 0.0670394918015157 1.0321529714526285 0.6588645353042365 2.254648001818121 1.9369070477053105 2.068878085022593 1.592234578306678 1.3020678764215246], :y [0.5142944511188816 3.190873293058793 1.1644144718830582 2.278542285798144 1.4822344073641283 0.2810064987985086 2.908591783281116 1.5270421307726934 0.7666465830538032 1.5382438819627575 0.8947361339178984 -0.13511791000690687 0.49745144906816785 0.34206505072732707 0.8421915697483491 1.7820045122350687 0.726240318827584 1.6690677425309233 0.2346659428462592 1.248463424556321 1.007157018209463 0.2602557074900146 1.5421016791342357 2.0230780311426377 2.3674992536657706 0.81404811380852 1.8678295893114947 1.4474317527899316 1.9606385208464208 1.8123604795647217 -0.022426860679804816 0.18291182275255824 0.6818242133207102 2.038352879411198 0.8802439782861964 -0.5530297551913892 0.1591430300733513 1.2465888026523877 0.6289184902086338 0.6283646417418098 -1.302076332470015 1.203374241294901 2.4481250422498047 1.099234388338458 1.284693085303855 1.6900611669673258 0.9821518321985526 1.2022237436313987 -0.5008354391779002 0.849839055331052], :name \"Class 1\", :type \"scatter\", :mode \"markers\"} {:x [0.349560034720641 0.9357619282723991 1.4663901278004428 -0.16827792917355475 0.5279626541216902 -2.3270564031070013 0.6686393781146788 -0.14143729400554567 -0.5433855070875816 0.025710619339052124 -0.9708498091335942 -0.18938221419218101 -0.5433698420230062 1.7357746106261494 -0.0951657535712722 2.720010923556669 0.5514773543221626 0.08731805950993865 2.183153985280867 0.8676074077366056 0.5374139565077989 -0.48491098652849096 -0.8116152701825693 2.2088339534134396 0.2166950728215243 -1.9237204742076957 -1.8290090782306698 0.9304828107517431 -0.6552735084527934 -0.14592697684959202 0.10429595445022612 0.5508288414840913 0.4894009053328757 -0.6511361797142053 0.5414526830425552 1.7805216022417776 1.169066373124237 1.89372209894508 0.45594211124449646 -0.8490239245990686 -0.03973527013152909 -0.18147002513063146 -0.8038221370742187 -0.48066299481789543 0.3003801761274062 1.352636008818893 0.7285176758560458 -1.3341206995531538 3.609798890289927 0.6632569044997341 0.9199853457965353 1.2165926669089484 -0.5852220660081506 1.4349768684908062 0.5647295596220372 0.7393633018726016 1.6147080237991678 2.696374094163395 1.2076056422885904 -0.25326594098612576 2.9718117713002323 -0.017312838268592312 0.21035706885573224 1.493293164886155 0.665553511971748 1.6111125668363022 0.3620316432794547 1.529465764798013 0.6691721928836668 0.2646365990944053 0.9926460345077271 -0.15243031518628336 1.7284448332300362 1.1570314657157081 2.891750876649942 2.172204001078428 0.8165031549727599 1.1509896752928728 -0.047189380699993455 -0.9525315963066621 2.712631569988106 -0.0489412475638169 1.6009452879102386 2.3341980105254114 2.609818290803452 0.34544485011244064 0.9429404733478447 1.267419252820873 -0.25918763952134327 -1.072409258829203 0.4274964289428721 2.1482517567496693 0.0670394918015157 1.0321529714526285 0.6588645353042365 2.254648001818121 1.9369070477053105 2.068878085022593 1.592234578306678 1.3020678764215246], :y [0.3701243022741069 -0.03723624250376667 -0.4059777883977339 0.7299777203524623 0.2461496289944234 2.230145469501211 0.14839124992106983 0.7113257578042401 0.9906456386417352 0.595172149657411 1.2876970348757228 0.7446434065894108 0.9906347527518913 -0.5931771319783198 0.6791709658693131 -1.2771378032690235 0.22980890886144234 0.5523602094940572 -0.9040678127939713 0.01012536263592101 0.23958177629517974 0.9500108116092754 1.1770425500504946 -0.921913210298542 0.46245416994679944 1.949861243994178 1.8840448652238702 -0.033567704048302005 1.0683982997839254 0.714445706186101 0.5405620140120319 0.23025957022217514 0.27294677033257564 1.0655232075888716 0.2367752042600078 -0.6242724919255046 -0.19936302305390952 -0.7029372258907688 0.29619779141828195 1.203038388702911 0.6406514861820286 0.7391451069729259 1.1716269842130842 0.9470588180444723 0.40430012839990576 -0.326928333954169 0.10678091693407599 1.5401394603456247 -1.895464893052218 0.15213161208665676 -0.0262728571875549 -0.2323897620330525 1.019718494974994 -0.38414824030793004 0.22059975135129434 0.09924412769616964 -0.5090461332443784 -1.2607122137163764 -0.22614454296168496 0.789037172688572 -1.4521180133991223 0.6250697998050224 0.4668585445772976 -0.4246731149805495 0.15053566488615883 -0.5065475959260425 0.3614575932227378 -0.4498100006989604 0.148020988895051 0.42913887964352915 -0.07676586661471252 0.7189649741667247 -0.5880835590198804 -0.1909997842240494 -1.3964824891558578 -0.8964585034773666 0.04563847932036624 -0.186801252856012 0.6458314601387931 1.2749674322616413 -1.2720097790799771 0.6470488588675852 -0.4994822003212359 -1.0090305860055317 -1.2005632793675662 0.3729840061786799 -0.04222472183966264 -0.2677099238306072 0.7931522503910693 1.3582722295491454 0.31596512544847283 -0.8798137273247383 0.5664520923076168 -0.10421983347051755 0.1551839357451532 -0.9537500841160832 -0.7329470986780849 -0.8246557646647169 -0.49342899672612506 -0.2917877754053372], :name \"Decision Boundary\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drxnVLheMUn1R5YMEbLiqcFjUKfyo\"}, :nextjournal/opts {:id \"logistic_regression/anon-expr-5drT8bADNRzDLvzr9yMbU5SUaLSd55-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}}], :css-class nil}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :index \"notebooks/logistic_regression.clj\", :browse? false, :paths [\"notebooks/logistic_regression.clj\"], :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true\"}, :current-path \"notebooks/logistic_regression.clj\", :bundle? false, :path->url {\"notebooks/logistic_regression.clj\" \"\"}, :expanded-paths [\"notebooks/logistic_regression.clj\"], :report-fn #function[nextjournal.clerk.builder/build-ui-reporter]}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
let opts = nextjournal.clerk.sci_env.read_string(state)
nextjournal.clerk.static_app.init(opts)
</script></body></html>