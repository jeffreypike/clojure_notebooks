<!DOCTYPE html>
<html><head><title>Linear Regression with Gradient Descent</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="In this notebook we train a linear regression model from scratch on synthetic data.  To make things slightly more interesting, we use gradient descent rather than the closed form solution." property="og:description"><meta content="Linear Regression with Gradient Descent" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }
  
  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply py-4 pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.notebook-viewer { @apply py-16; }
#clerk-static-app .notebook-viewer { @apply pt-[0.8rem] pb-16; }
.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[205px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.markdown-viewer):not(.code-viewer):not(.code-viewer-folded),
.result-viewer + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body><div id="clerk-static-app"></div><script type="module">let state = "{:out-path \"public/build\", :path->doc {\"notebooks/linear_regression.clj\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:type :toc, :content [{:type :text, :text \"Linear Regression with Gradient Descent\"}], :heading-level 1, :attrs {:id \"linear-regression-with-gradient-descent\"}, :path [:content 0], :children [{:type :toc, :content [{:type :text, :text \"Setup\"}], :heading-level 2, :attrs {:id \"setup\"}, :path [:content 2], :children [{:type :toc, :content [{:type :text, :text \"Utility Functions\"}], :heading-level 3, :attrs {:id \"utility-functions\"}, :path [:content 3]} {:type :toc, :content [{:type :text, :text \"Regression Functions\"}], :heading-level 3, :attrs {:id \"regression-functions\"}, :path [:content 5]}]} {:type :toc, :content [{:type :text, :text \"Univariate Regression\"}], :heading-level 2, :attrs {:id \"univariate-regression\"}, :path [:content 7], :children [{:type :toc, :content [{:type :text, :text \"Generate Random Data\"}], :heading-level 3, :attrs {:id \"generate-random-data\"}, :path [:content 9]} {:type :toc, :content [{:type :text, :text \"Initialize Random Parameters\"}], :heading-level 3, :attrs {:id \"initialize-random-parameters\"}, :path [:content 13]} {:type :toc, :content [{:type :text, :text \"Train the Model\"}], :heading-level 3, :attrs {:id \"train-the-model\"}, :path [:content 18]}]} {:type :toc, :content [{:type :text, :text \"Multivariate Regression\"}], :heading-level 2, :attrs {:id \"multivariate-regression\"}, :path [:content 23], :children [{:type :toc, :content [{:type :text, :text \"Generate Random Data\"}], :heading-level 3, :attrs {:id \"generate-random-data-2\"}, :path [:content 25]} {:type :toc, :content [{:type :text, :text \"Initialize Random Parameters\"}], :heading-level 3, :attrs {:id \"initialize-random-parameters-2\"}, :path [:content 29]}]} {:type :toc, :content [{:type :text, :text \"Train the Model\"}], :heading-level 2, :attrs {:id \"train-the-model-2\"}, :path [:content 34]}]}]}, :sidenotes? false, :toc-visibility false, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns linear_regression), :auto-expand-results? nil, :scope linear_regression, :bundle? false, :open-graph {:type \"article:clerk\", :title \"Linear Regression with Gradient Descent\", :description \"In this notebook we train a linear regression model from scratch on synthetic data.  To make things slightly more interesting, we use gradient descent rather than the closed form solution.\"}, :title \"Linear Regression with Gradient Descent\", :blocks [{:nextjournal/value [:div.markdown-viewer [\"h1\" {:id \"linear-regression-with-gradient-descent\"} [:<> \"Linear Regression with Gradient Descent\"]] [:p [:<> \"In this notebook we train a linear regression model from scratch on\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"synthetic data.  To make things slightly more interesting, we use\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"gradient descent rather than the closed form solution.\"]] [\"h2\" {:id \"setup\"} [:<> \"Setup\"]]], :nextjournal/opts {:id \"basic_neural_nets/markdown-5drYsyE7oqt3x7KjvP1ot4fFbuq1SL\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(ns linear_regression\\n  (:require [nextjournal.clerk :as clerk] \\n            [uncomplicate.neanderthal\\n             [native :refer [dv dge]]\\n             [core :refer [axpby! mv xpy entry ax dot dim trans sum col mrows]]\\n             [random :refer [rand-normal!]]]\\n            [tablecloth.api :as tc]))\", :nextjournal/opts {:id \"linear_regression/anon-expr-5drbRLnBCJ6eeiSTpLpHGey1HYzK1n-code\", :loc {:line 7, :end-line 13, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"utility-functions\"} [:<> \"Utility Functions\"]] [:p [:<> \"First let's define a couple of quality of life functions\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5drMjnyhqSUxkkYw2QgMWaKZLbfmfP\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn ->vec \\n  \\\"For converting Neanderthal vectors into Clojure vectors\\\"\\n  [x] \\n  (into [] x))\", :nextjournal/opts {:id \"linear_regression/->vec-code\", :loc {:line 18, :end-line 21, :column 1, :end-column 15}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/->vec]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/->vec-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn mean\\n  \\\"Take the mean of a Neanderthal vector\\\"\\n  [x]\\n  (* (/ 1 (dim x)) (sum x)))\", :nextjournal/opts {:id \"linear_regression/mean-code\", :loc {:line 23, :end-line 26, :column 1, :end-column 29}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/mean]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/mean-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"regression-functions\"} [:<> \"Regression Functions\"]] [:p [:<> \"Now let's get in to the real meat of the notebook: the functions that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"define and train the regression models.  We'll introduce the model itself,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"the R-squared goodness of fit measure, and a bare-bones gradient decscent algorithm.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtUZMVp6BujtL3iZ61ZwtCVYboBME\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(defn linear_regression\\n  \\\"A typical linear equation\\\"\\n  [params X]\\n  (xpy (mv X (get params :weights)) \\n       (ax (get params :bias) (dv (repeat (mrows X) 1)))))\", :nextjournal/opts {:id \"linear_regression/linear_regression-code\", :loc {:line 33, :end-line 37, :column 1, :end-column 59}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/linear-regression]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/linear_regression-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn r2\\n  \\\"The R-squared of a linear regression\\\"\\n  [Yhat Y]\\n  (- 1 (/ (dot (xpy Yhat (ax -1 Y))\\n               (xpy Yhat (ax -1 Y)))\\n          (dot (xpy Y (ax -1 (ax (mean Y) (dv (repeat (dim Y) 1)))))\\n               (xpy Y (ax -1 (ax (mean Y) (dv (repeat (dim Y) 1)))))))))\", :nextjournal/opts {:id \"linear_regression/r2-code\", :loc {:line 39, :end-line 45, :column 1, :end-column 73}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/r2]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/r2-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn step\\n  \\\"Perform one step of gradient descent\\\"\\n  [params X y learning_rate]\\n  {:weights (xpy (get params :weights) \\n                 (ax (* -1 learning_rate) \\n                     (mv (trans X) \\n                         (xpy (linear_regression params X) \\n                              (ax -1 y)))))\\n   :bias (+ (get params :bias)\\n              (* (* -1 learning_rate)\\n                  (sum (xpy (linear_regression params X)\\n                            (ax -1 y)))))})\", :nextjournal/opts {:id \"linear_regression/step-code\", :loc {:line 47, :end-line 58, :column 1, :end-column 44}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/step]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/step-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(defn train\\n  \\\"Train a linear regression model with gradient descent\\\"\\n  ([params X y learning_rate epochs count]\\n   (if (= epochs count)\\n     params \\n     (recur (step params X y learning_rate) X y learning_rate epochs (inc count))))\\n   ([params X y learning_rate epochs]\\n    (train params X y learning_rate epochs 0)))\", :nextjournal/opts {:id \"linear_regression/train-code\", :loc {:line 60, :end-line 67, :column 1, :end-column 48}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#function[linear-regression/train]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"linear_regression/train-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h2\" {:id \"univariate-regression\"} [:<> \"Univariate Regression\"]] [:p [:<> \"We'll start with the single variable case so that we can easily\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"visualize what's going on, but the goal is that our code generalizes\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"seamlessly to the multivariate setting.\"]] [\"h3\" {:id \"generate-random-data\"} [:<> \"Generate Random Data\"]] [:p [:<> \"First we generate some synthetic data.  We'll use the line y = 2x as\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"our baseline and add some random noise.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5ds3JkMbdDb3XBUX6arCisxYFBtLxS\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def x (rand-normal! (dv 100)))\", :nextjournal/opts {:id \"linear_regression/x-code\", :loc {:line 78, :end-line 78, :column 1, :end-column 32}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[1.3     .34     -1.52E-2   ⋯   .15     .25     ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5drsJZv5iYLkRPEy3GJpZfQiwJJ6Mc\"}, :nextjournal/opts {:id \"linear_regression/x-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def y (axpby! 2 x 1 (rand-normal! (dv 100))))\", :nextjournal/opts {:id \"linear_regression/y-code\", :loc {:line 79, :end-line 79, :column 1, :end-column 47}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[   1.23    1.51    1.57    ⋯      0.25    1.30 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dspYzSVq45vAZDrLr9NwKvPeDEWf5\"}, :nextjournal/opts {:id \"linear_regression/y-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"For this notebook, creating an R-like (or pandas-like) dataframe\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"is completely unnecessary, but let's do it anyways!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtDxTnRU2bCNnhbF7c9LkSMsEbhxm\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/table (tc/dataset {:x (->vec x) :y (->vec y)}))\", :nextjournal/opts {:id \"linear_regression/anon-expr-5drqLgzerbYw2vuZdqpZHzmjJM7SwZ-code\", :loc {:line 84, :end-line 84, :column 1, :end-column 55}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :x, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value :y, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-head-viewer, :render-fn #viewer-fn (fn [header-row {:as opts, :keys [path number-col?]}] [:thead (into [:tr] (map-indexed (fn [i {:as header-cell, :nextjournal/keys [value]}] (let [title (when (or (string? value) (keyword? value) (symbol? value)) value)] [:th.pl-6.pr-2.py-1.align-bottom.font-medium.top-0.z-10.bg-white.dark:bg-slate-900.border-b.border-gray-300.dark:border-slate-700 (cond-> {:class (when (and (ifn? number-col?) (number-col? i)) \"text-right\")} title (assoc :title title)) [:div.flex.items-center (nextjournal.clerk.render/inspect-presented opts header-cell)]]))) header-row)]), :hash \"5dszDR5S2VhSEk6vkkHpb1FBgtPV99\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value 1.276625082946955, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 1], :nextjournal/value 1.225941684522588, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value 0.33821252571199106, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 1], :nextjournal/value 1.5106219066452125, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 2], :nextjournal/value [{:path [1 2 0], :nextjournal/value -0.015154685812588078, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 1], :nextjournal/value 1.566653091770661, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 3], :nextjournal/value [{:path [1 3 0], :nextjournal/value 1.1514083591093647, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 1], :nextjournal/value 2.8008610401050813, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 4], :nextjournal/value [{:path [1 4 0], :nextjournal/value 0.08466683818920859, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 1], :nextjournal/value 0.7841932389791739, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 5], :nextjournal/value [{:path [1 5 0], :nextjournal/value -2.2940118233337805, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 1], :nextjournal/value -3.0953970339906443, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 6], :nextjournal/value [{:path [1 6 0], :nextjournal/value -1.8944399920130037, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 1], :nextjournal/value -4.992399011689813, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 7], :nextjournal/value [{:path [1 7 0], :nextjournal/value 1.8734083964028856, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 1], :nextjournal/value 1.4423406136074828, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 8], :nextjournal/value [{:path [1 8 0], :nextjournal/value 0.4963401000269245, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 1], :nextjournal/value 2.8481444994596963, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 9], :nextjournal/value [{:path [1 9 0], :nextjournal/value -0.7295412002016103, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 1], :nextjournal/value -0.5260804078213344, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 10], :nextjournal/value [{:path [1 10 0], :nextjournal/value 0.5687575978167342, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 1], :nextjournal/value 0.46765869128412074, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 11], :nextjournal/value [{:path [1 11 0], :nextjournal/value -0.16940902059324436, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 1], :nextjournal/value -0.7049280936602185, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 12], :nextjournal/value [{:path [1 12 0], :nextjournal/value -0.10505190979435611, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 1], :nextjournal/value 0.3757589532990236, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 13], :nextjournal/value [{:path [1 13 0], :nextjournal/value 2.305262699895484, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 1], :nextjournal/value 3.776719246185941, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 14], :nextjournal/value [{:path [1 14 0], :nextjournal/value 0.10257559413383478, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 1], :nextjournal/value -0.890313997942997, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 15], :nextjournal/value [{:path [1 15 0], :nextjournal/value -1.5694211105091342, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 1], :nextjournal/value -3.4773338838252945, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 16], :nextjournal/value [{:path [1 16 0], :nextjournal/value 0.10218547957102328, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 1], :nextjournal/value -0.06781307349242627, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 17], :nextjournal/value [{:path [1 17 0], :nextjournal/value 0.888606832823486, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 1], :nextjournal/value 0.9961731205671867, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 18], :nextjournal/value [{:path [1 18 0], :nextjournal/value 1.4475086743774093, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 1], :nextjournal/value 4.380315850765798, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 19], :nextjournal/value [{:path [1 19 0], :nextjournal/value -1.3371888432529913, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 1], :nextjournal/value -3.229927387423877, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:nextjournal/value {:n 20, :path [1], :total 100, :offset 20}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn (fn [{:as fetch-opts, :keys [total offset unbounded?]} {:keys [num-cols]}] [nextjournal.clerk.render/consume-view-context :fetch-fn (fn [fetch-fn] [:tr.border-t.dark:border-slate-700 [:td.py-1.relative {:col-span num-cols, :class (if (fn? fetch-fn) \"bg-indigo-50 hover:bg-indigo-100 dark:bg-gray-800 dark:hover:bg-slate-700 cursor-pointer\" \"text-gray-400 text-slate-500\"), :on-click (fn [_] (when (fn? fetch-fn) (fetch-fn fetch-opts)))} [:span.sticky {:style {:left \"min(50vw, 50%)\"}, :class \"-translate-x-1/2\"} (- total offset) (when unbounded? \"+\") (if (fn? fetch-fn) \" more…\" \" more elided\")]]])]), :hash \"5drUHyj6Bew7ppqVaxrQbZrbNErYSX\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-body-viewer, :page-size 20, :render-fn #viewer-fn (fn [rows opts] (into [:tbody] (map-indexed (fn [idx row] (nextjournal.clerk.render/inspect-presented (update opts :path conj idx) row))) rows)), :hash \"5dt4ysvbhnCYY7GiXxiZuSL8MN8TVv\"}}], :nextjournal/width :wide, :nextjournal/opts {:num-cols 2, :number-col? #{0 1}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/table-markup-viewer, :render-fn #viewer-fn (fn [head+body opts] [:div (into [nextjournal.clerk.render/render-table-with-sticky-header] (nextjournal.clerk.render/inspect-children opts) head+body)]), :hash \"5dr1LyqxYnX13V68FDhw2cWLsZEBsm\"}}, :nextjournal/blob-id \"5dtUDGLYabkvH87D8EYQWCsxHDfcVU\"}, :nextjournal/width :wide, :nextjournal/opts {:id \"linear_regression/anon-expr-5drqLgzerbYw2vuZdqpZHzmjJM7SwZ-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"And to cap this section off, let's plot the data we created.s\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5drygeCkkGHDLKUukK475ktsNvT74t\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec x) \\n                       :y (->vec y) \\n                       :type \\\"scatter\\\" \\n                       :mode \\\"markers\\\"}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5drMEdbDfpYN2GZKWpcbbg42KZ6RuM-code\", :loc {:line 88, :end-line 91, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [1.276625082946955 0.33821252571199106 -0.015154685812588078 1.1514083591093647 0.08466683818920859 -2.2940118233337805 -1.8944399920130037 1.8734083964028856 0.4963401000269245 -0.7295412002016103 0.5687575978167342 -0.16940902059324436 -0.10505190979435611 2.305262699895484 0.10257559413383478 -1.5694211105091342 0.10218547957102328 0.888606832823486 1.4475086743774093 -1.3371888432529913 1.4692173371481818 -0.7003986003206867 -0.058559318415373596 -1.3648237093564568 -2.058039644016675 -0.5115824370088862 -0.6194736912359307 -0.4866026307190939 0.5918494637069253 0.8942656451531616 0.004037802992271605 2.4410428860614917 -1.0036859638676396 1.5650519942107861 -0.6344539503942214 1.0530857578471275 -0.25507191386058 0.19390656841366768 0.9799702148783344 0.40250697920909384 -1.1246971842241689 1.1558893002621817 -0.2598297816729015 -0.7543045709802693 -1.1456389337606994 0.36031431036796574 1.3322765677197304 1.059456214303732 -0.3777026473119536 -0.835753015253447 0.38144213707401936 0.048410292669787205 -1.7731006481549278 0.5563901142952982 -1.4970497668541969 -0.16497616012409316 1.8802183244954604 0.6211986507739176 -0.12339870888598348 -0.5283783729671574 -0.04475074191762692 -0.5291086390485218 1.011036975737482 0.7340337347452428 -0.2515414198608963 -0.12163432177108391 -0.6002519570674462 -0.7172953970194849 0.5705049486596846 0.8891589085198801 -0.9135875281291574 0.012926728618433074 -0.21844479534120342 -0.3331469686539879 0.04431227732881454 0.6202560939858444 -0.9807294326975756 -0.4402478255364501 1.8634242382949744 1.3807998538239252 -0.6020789172088682 -2.3012151777421095 -0.9263358579439309 0.6724700624264194 -1.638047256658234 -0.5464231359433663 0.6002413440481827 -0.008797953573587135 0.1861795503765656 -1.1200580223175471 0.005043983670935883 -0.4658959083695195 -0.958549809495067 0.2863623507439862 -0.34617984632225673 -0.36298875265086733 -0.9891869177283821 -1.1118542994126885 0.15181671349921114 0.24794119424744807], :y [1.225941684522588 1.5106219066452125 1.566653091770661 2.8008610401050813 0.7841932389791739 -3.0953970339906443 -4.992399011689813 1.4423406136074828 2.8481444994596963 -0.5260804078213344 0.46765869128412074 -0.7049280936602185 0.3757589532990236 3.776719246185941 -0.890313997942997 -3.4773338838252945 -0.06781307349242627 0.9961731205671867 4.380315850765798 -3.229927387423877 2.8668755676771984 -0.5967774068992852 0.43659344532471356 -2.3691861301503487 -4.674628593472249 -1.0178442884722505 -0.5432535714845917 -1.1358920005765811 0.18059859719972304 2.2542023789977623 1.633301075059639 5.235523020181662 -0.31899292863471485 3.623323501661534 -1.9855457908366239 1.8847784462996193 -0.7862236443319004 -0.3128977722827155 3.8293284661236857 0.7689623242631927 -2.837858231315824 4.145491604359446 -0.52412506316024 -0.452530784821942 -3.8242014896403536 1.5859742507875216 4.214679311114921 2.8391688682695277 -0.8810841911088462 -2.3630200937832324 1.6276107693043425 -1.0866489516133113 -5.0913309521511145 1.525840578662906 -2.224309496095516 1.0114597537651382 4.375484279178769 0.1259783989247849 -0.7147178945010998 -2.0554982318580954 0.40663860961279236 -1.26480736531783 3.2607294766460875 2.89545112626646 -0.34640002350825616 -1.2085573081504022 -2.8792191330713877 -0.04534822315607201 1.7807332993333786 2.34348944705745 -0.6311764100352952 0.14431314106942356 -2.1166293172975834 -0.9013757922764618 0.5343605398306579 1.1750843776169964 -2.804119790077036 -0.912516699223421 4.645123225149134 2.174706945726962 -0.715487563454784 -3.6482043628432805 -1.6854477360213729 1.7776925204310006 -3.9131302669633414 -2.383556179441816 -0.5258271188675252 -0.8036667317588441 0.7086862448318584 -2.230624142052203 0.41406097348380677 -0.6130073400650253 -1.3632675045058278 0.9735595012675673 0.12160033253537894 0.21468630664003407 -2.5913288107245944 -2.4297597425520236 0.24811917715025775 1.3045241300421657], :type \"scatter\", :mode \"markers\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drdocMoSgAyyFadkeNUA76UUBgLtm\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5drMEdbDfpYN2GZKWpcbbg42KZ6RuM-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"initialize-random-parameters\"} [:<> \"Initialize Random Parameters\"]] [:p [:<> \"Since we're using gradient descent, let's start our model off by\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"initializing some random parameters.  In the 1D case, both the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"weight and the bias are scalar, but since we want to easily generalize\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"to multivariate regression, let's make the weight a 1D vector.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dqufBc74QTT9Pp3rZvdowofvR8skm\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_init \\n  {:weights (rand-normal! (dv 1)) \\n   :bias (entry (rand-normal! (dv 1)) 0)})\", :nextjournal/opts {:id \"linear_regression/params_init-code\", :loc {:line 99, :end-line 101, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value -0.47919643162882775, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:1, offset: 0, stride:1]\\n[  -2.04 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5drneocguFG14CojuuZUDgwJ2XsUQY\"}, :nextjournal/opts {:id \"linear_regression/params_init-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Just for fun, let's create a model with these random weights.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dqvCAEGvmmoE88vmV1qdMt7wq6m9P\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def yhat_rdm (linear_regression params_init (dge 100 1 x)))\", :nextjournal/opts {:id \"linear_regression/yhat_rdm-code\", :loc {:line 104, :end-line 104, :column 1, :end-column 61}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[  -3.08   -1.17   -0.45    ⋯     -0.79   -0.98 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dsFBZtbSncn1BjYnmAJ1UoVCbcx76\"}, :nextjournal/opts {:id \"linear_regression/yhat_rdm-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"How does this model do?  Unless we're very lucky, this R-squared should\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"be quite far from 1.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dsMW4xjjUqm7icHrYJGzVzhYzyDZG\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(r2 yhat_rdm y)\", :nextjournal/opts {:id \"linear_regression/anon-expr-5drZgfhug5UVXS7yJ81f67fJqDFLWK-code\", :loc {:line 108, :end-line 108, :column 1, :end-column 16}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value -1.7596175682578759, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}, :nextjournal/blob-id \"5drx2j86dExqj9iTL4UqLWcMjhNWky\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5drZgfhug5UVXS7yJ81f67fJqDFLWK-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Let's see just how bad this model is:\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dsF8rZmRkT4DVqZnCZZLGYTVKJG7U\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec x)\\n                       :y (->vec y)\\n                       :name \\\"data\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec x)\\n                       :y (->vec yhat_rdm)\\n                       :name \\\"regression\\\"}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5du9DYSMKsxAvf1aRqrZWvDCwWeiLz-code\", :loc {:line 111, :end-line 118, :column 1, :end-column 46}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [1.276625082946955 0.33821252571199106 -0.015154685812588078 1.1514083591093647 0.08466683818920859 -2.2940118233337805 -1.8944399920130037 1.8734083964028856 0.4963401000269245 -0.7295412002016103 0.5687575978167342 -0.16940902059324436 -0.10505190979435611 2.305262699895484 0.10257559413383478 -1.5694211105091342 0.10218547957102328 0.888606832823486 1.4475086743774093 -1.3371888432529913 1.4692173371481818 -0.7003986003206867 -0.058559318415373596 -1.3648237093564568 -2.058039644016675 -0.5115824370088862 -0.6194736912359307 -0.4866026307190939 0.5918494637069253 0.8942656451531616 0.004037802992271605 2.4410428860614917 -1.0036859638676396 1.5650519942107861 -0.6344539503942214 1.0530857578471275 -0.25507191386058 0.19390656841366768 0.9799702148783344 0.40250697920909384 -1.1246971842241689 1.1558893002621817 -0.2598297816729015 -0.7543045709802693 -1.1456389337606994 0.36031431036796574 1.3322765677197304 1.059456214303732 -0.3777026473119536 -0.835753015253447 0.38144213707401936 0.048410292669787205 -1.7731006481549278 0.5563901142952982 -1.4970497668541969 -0.16497616012409316 1.8802183244954604 0.6211986507739176 -0.12339870888598348 -0.5283783729671574 -0.04475074191762692 -0.5291086390485218 1.011036975737482 0.7340337347452428 -0.2515414198608963 -0.12163432177108391 -0.6002519570674462 -0.7172953970194849 0.5705049486596846 0.8891589085198801 -0.9135875281291574 0.012926728618433074 -0.21844479534120342 -0.3331469686539879 0.04431227732881454 0.6202560939858444 -0.9807294326975756 -0.4402478255364501 1.8634242382949744 1.3807998538239252 -0.6020789172088682 -2.3012151777421095 -0.9263358579439309 0.6724700624264194 -1.638047256658234 -0.5464231359433663 0.6002413440481827 -0.008797953573587135 0.1861795503765656 -1.1200580223175471 0.005043983670935883 -0.4658959083695195 -0.958549809495067 0.2863623507439862 -0.34617984632225673 -0.36298875265086733 -0.9891869177283821 -1.1118542994126885 0.15181671349921114 0.24794119424744807], :y [1.225941684522588 1.5106219066452125 1.566653091770661 2.8008610401050813 0.7841932389791739 -3.0953970339906443 -4.992399011689813 1.4423406136074828 2.8481444994596963 -0.5260804078213344 0.46765869128412074 -0.7049280936602185 0.3757589532990236 3.776719246185941 -0.890313997942997 -3.4773338838252945 -0.06781307349242627 0.9961731205671867 4.380315850765798 -3.229927387423877 2.8668755676771984 -0.5967774068992852 0.43659344532471356 -2.3691861301503487 -4.674628593472249 -1.0178442884722505 -0.5432535714845917 -1.1358920005765811 0.18059859719972304 2.2542023789977623 1.633301075059639 5.235523020181662 -0.31899292863471485 3.623323501661534 -1.9855457908366239 1.8847784462996193 -0.7862236443319004 -0.3128977722827155 3.8293284661236857 0.7689623242631927 -2.837858231315824 4.145491604359446 -0.52412506316024 -0.452530784821942 -3.8242014896403536 1.5859742507875216 4.214679311114921 2.8391688682695277 -0.8810841911088462 -2.3630200937832324 1.6276107693043425 -1.0866489516133113 -5.0913309521511145 1.525840578662906 -2.224309496095516 1.0114597537651382 4.375484279178769 0.1259783989247849 -0.7147178945010998 -2.0554982318580954 0.40663860961279236 -1.26480736531783 3.2607294766460875 2.89545112626646 -0.34640002350825616 -1.2085573081504022 -2.8792191330713877 -0.04534822315607201 1.7807332993333786 2.34348944705745 -0.6311764100352952 0.14431314106942356 -2.1166293172975834 -0.9013757922764618 0.5343605398306579 1.1750843776169964 -2.804119790077036 -0.912516699223421 4.645123225149134 2.174706945726962 -0.715487563454784 -3.6482043628432805 -1.6854477360213729 1.7776925204310006 -3.9131302669633414 -2.383556179441816 -0.5258271188675252 -0.8036667317588441 0.7086862448318584 -2.230624142052203 0.41406097348380677 -0.6130073400650253 -1.3632675045058278 0.9735595012675673 0.12160033253537894 0.21468630664003407 -2.5913288107245944 -2.4297597425520236 0.24811917715025775 1.3045241300421657], :name \"data\", :type \"scatter\", :mode \"markers\"} {:x [1.276625082946955 0.33821252571199106 -0.015154685812588078 1.1514083591093647 0.08466683818920859 -2.2940118233337805 -1.8944399920130037 1.8734083964028856 0.4963401000269245 -0.7295412002016103 0.5687575978167342 -0.16940902059324436 -0.10505190979435611 2.305262699895484 0.10257559413383478 -1.5694211105091342 0.10218547957102328 0.888606832823486 1.4475086743774093 -1.3371888432529913 1.4692173371481818 -0.7003986003206867 -0.058559318415373596 -1.3648237093564568 -2.058039644016675 -0.5115824370088862 -0.6194736912359307 -0.4866026307190939 0.5918494637069253 0.8942656451531616 0.004037802992271605 2.4410428860614917 -1.0036859638676396 1.5650519942107861 -0.6344539503942214 1.0530857578471275 -0.25507191386058 0.19390656841366768 0.9799702148783344 0.40250697920909384 -1.1246971842241689 1.1558893002621817 -0.2598297816729015 -0.7543045709802693 -1.1456389337606994 0.36031431036796574 1.3322765677197304 1.059456214303732 -0.3777026473119536 -0.835753015253447 0.38144213707401936 0.048410292669787205 -1.7731006481549278 0.5563901142952982 -1.4970497668541969 -0.16497616012409316 1.8802183244954604 0.6211986507739176 -0.12339870888598348 -0.5283783729671574 -0.04475074191762692 -0.5291086390485218 1.011036975737482 0.7340337347452428 -0.2515414198608963 -0.12163432177108391 -0.6002519570674462 -0.7172953970194849 0.5705049486596846 0.8891589085198801 -0.9135875281291574 0.012926728618433074 -0.21844479534120342 -0.3331469686539879 0.04431227732881454 0.6202560939858444 -0.9807294326975756 -0.4402478255364501 1.8634242382949744 1.3807998538239252 -0.6020789172088682 -2.3012151777421095 -0.9263358579439309 0.6724700624264194 -1.638047256658234 -0.5464231359433663 0.6002413440481827 -0.008797953573587135 0.1861795503765656 -1.1200580223175471 0.005043983670935883 -0.4658959083695195 -0.958549809495067 0.2863623507439862 -0.34617984632225673 -0.36298875265086733 -0.9891869177283821 -1.1118542994126885 0.15181671349921114 0.24794119424744807], :y [-3.0806760968040545 -1.1683987823426722 -0.4483145325496088 -2.825512098262371 -0.6517287285467784 4.195492472570264 3.3812534231867897 -4.296788544546087 -1.490627817772706 1.0074472373573293 -1.638198667209705 -0.13397830294124613 -0.26512386579221 -5.1768121347617955 -0.6882228136473034 2.718936802336371 -0.6874278464201986 -2.2899806914757055 -3.4288990748394235 2.245698786779146 -3.4731365299158545 0.9480610620476977 -0.35986548779960836 2.3020125340008843 3.714633343104107 0.5632954672983239 0.7831539893273551 0.5123921449596299 -1.6852547844258994 -2.301512099875352 -0.48742458139393363 -5.453502134012932 1.5660936540054635 -3.668426372562449 0.8136804454497653 -2.6251523754059227 0.0405837340043409 -0.8743351465188793 -2.4761590642276055 -1.2994166634657374 1.8126877662634238 -2.834643265623576 0.050279216670852445 1.0579095119768798 1.855362421728219 -1.2134373329043404 -3.1940815185736025 -2.6381339571961573 0.29047805588531517 1.2238834336608497 -1.256491172500118 -0.5778459048750506 3.133990667778744 -1.612996470166752 2.5714600048218488 -0.1430114924994801 -4.310665672365982 -1.7450619387455961 -0.2277371456067136 0.5975218713042396 -0.388004313711583 0.5990099921207688 -2.5394662541908253 -1.9749948927434446 0.03338936780326418 -0.2313325764518548 0.7439843448979311 0.9824929979431245 -1.6417593818992278 -2.2911056996844517 1.38249296217455 -0.505538246533846 -0.03405423550990866 0.19968343376398578 -0.569495055655868 -1.74314121640495 1.519313319027223 0.41793130075669827 -4.2764430377574625 -3.2929612474570025 0.7477072857366178 4.2101713162375525 1.4084712397605765 -1.8495417399029683 2.858781715373885 0.6342931086648209 -1.7023555811688005 -0.4612681474187065 -0.8585891921549242 1.8032341799875904 -0.48947495515675754 0.47019642293880115 1.4741161507173375 -1.0627395895092766 0.2262415569636742 0.2604943917166731 1.5365478036226357 1.7865168064996308 -0.7885653280085189 -0.9844457672482173], :name \"regression\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drF2PdGCQaCsmDEpMSEVWd6wTedeU\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5du9DYSMKsxAvf1aRqrZWvDCwWeiLz-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"train-the-model\"} [:<> \"Train the Model\"]] [:p [:<> \"Now let's train the model!  We'll use a learning rate of 0.0001 and\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"train for 1000 epochs.  Both of these numbers were arbitrarily chosen,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"I'm sure we could have made significantly more efficient choices!  We\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"will hopefully end up with a weight close to 2 and a bias close to 0,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"but it won't be exact because of the noise.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dsACB9axxNsZrskNE9DX6aL99hiYg\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_optimal (train params_init (dge 100 1 x) y 0.0001 1000))\", :nextjournal/opts {:id \"linear_regression/params_optimal-code\", :loc {:line 127, :end-line 127, :column 1, :end-column 69}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value 0.11069935103571729, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:1, offset: 0, stride:1]\\n[   2.09 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dsLXPSorZUWhgLqVYK5wKAAHG1PM5\"}, :nextjournal/opts {:id \"linear_regression/params_optimal-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Awesome, let's create a model with these parameters!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtURypppMCipQfPapfK9kLEaynyYu\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def yhat (linear_regression params_optimal (dge 100 1 x)))\", :nextjournal/opts {:id \"linear_regression/yhat-code\", :loc {:line 131, :end-line 131, :column 1, :end-column 60}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[   2.78    0.82    0.08    ⋯      0.43    0.63 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dtyPqvfRm6QQAUATcm5bUEV4tm7mo\"}, :nextjournal/opts {:id \"linear_regression/yhat-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"The R-squared of this model will be much closer to 1 than that of the random model.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dsxfvh5SexoDD3FECENSGgzf67PWK\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(r2 yhat y)\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dtbowGws35Jy45N3XTqxt82ByNiBi-code\", :loc {:line 135, :end-line 135, :column 1, :end-column 12}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value 0.764898185902416, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}, :nextjournal/blob-id \"5drAetcfVWXTdSMxcjftZERVQGQmMh\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dtbowGws35Jy45N3XTqxt82ByNiBi-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Finally, let's admire our work!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5du9rgvGy9ssYrHcebKBcH4GSoZA8w\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec x)\\n                       :y (->vec y)\\n                       :name \\\"data\\\"\\n                       :type \\\"scatter\\\"\\n                       :mode \\\"markers\\\"}\\n                      {:x (->vec x)\\n                       :y (->vec yhat)\\n                       :name \\\"regression\\\"}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dr9n8hBf8WR43KDxtiqBQgQFTExuT-code\", :loc {:line 139, :end-line 146, :column 1, :end-column 46}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [1.276625082946955 0.33821252571199106 -0.015154685812588078 1.1514083591093647 0.08466683818920859 -2.2940118233337805 -1.8944399920130037 1.8734083964028856 0.4963401000269245 -0.7295412002016103 0.5687575978167342 -0.16940902059324436 -0.10505190979435611 2.305262699895484 0.10257559413383478 -1.5694211105091342 0.10218547957102328 0.888606832823486 1.4475086743774093 -1.3371888432529913 1.4692173371481818 -0.7003986003206867 -0.058559318415373596 -1.3648237093564568 -2.058039644016675 -0.5115824370088862 -0.6194736912359307 -0.4866026307190939 0.5918494637069253 0.8942656451531616 0.004037802992271605 2.4410428860614917 -1.0036859638676396 1.5650519942107861 -0.6344539503942214 1.0530857578471275 -0.25507191386058 0.19390656841366768 0.9799702148783344 0.40250697920909384 -1.1246971842241689 1.1558893002621817 -0.2598297816729015 -0.7543045709802693 -1.1456389337606994 0.36031431036796574 1.3322765677197304 1.059456214303732 -0.3777026473119536 -0.835753015253447 0.38144213707401936 0.048410292669787205 -1.7731006481549278 0.5563901142952982 -1.4970497668541969 -0.16497616012409316 1.8802183244954604 0.6211986507739176 -0.12339870888598348 -0.5283783729671574 -0.04475074191762692 -0.5291086390485218 1.011036975737482 0.7340337347452428 -0.2515414198608963 -0.12163432177108391 -0.6002519570674462 -0.7172953970194849 0.5705049486596846 0.8891589085198801 -0.9135875281291574 0.012926728618433074 -0.21844479534120342 -0.3331469686539879 0.04431227732881454 0.6202560939858444 -0.9807294326975756 -0.4402478255364501 1.8634242382949744 1.3807998538239252 -0.6020789172088682 -2.3012151777421095 -0.9263358579439309 0.6724700624264194 -1.638047256658234 -0.5464231359433663 0.6002413440481827 -0.008797953573587135 0.1861795503765656 -1.1200580223175471 0.005043983670935883 -0.4658959083695195 -0.958549809495067 0.2863623507439862 -0.34617984632225673 -0.36298875265086733 -0.9891869177283821 -1.1118542994126885 0.15181671349921114 0.24794119424744807], :y [1.225941684522588 1.5106219066452125 1.566653091770661 2.8008610401050813 0.7841932389791739 -3.0953970339906443 -4.992399011689813 1.4423406136074828 2.8481444994596963 -0.5260804078213344 0.46765869128412074 -0.7049280936602185 0.3757589532990236 3.776719246185941 -0.890313997942997 -3.4773338838252945 -0.06781307349242627 0.9961731205671867 4.380315850765798 -3.229927387423877 2.8668755676771984 -0.5967774068992852 0.43659344532471356 -2.3691861301503487 -4.674628593472249 -1.0178442884722505 -0.5432535714845917 -1.1358920005765811 0.18059859719972304 2.2542023789977623 1.633301075059639 5.235523020181662 -0.31899292863471485 3.623323501661534 -1.9855457908366239 1.8847784462996193 -0.7862236443319004 -0.3128977722827155 3.8293284661236857 0.7689623242631927 -2.837858231315824 4.145491604359446 -0.52412506316024 -0.452530784821942 -3.8242014896403536 1.5859742507875216 4.214679311114921 2.8391688682695277 -0.8810841911088462 -2.3630200937832324 1.6276107693043425 -1.0866489516133113 -5.0913309521511145 1.525840578662906 -2.224309496095516 1.0114597537651382 4.375484279178769 0.1259783989247849 -0.7147178945010998 -2.0554982318580954 0.40663860961279236 -1.26480736531783 3.2607294766460875 2.89545112626646 -0.34640002350825616 -1.2085573081504022 -2.8792191330713877 -0.04534822315607201 1.7807332993333786 2.34348944705745 -0.6311764100352952 0.14431314106942356 -2.1166293172975834 -0.9013757922764618 0.5343605398306579 1.1750843776169964 -2.804119790077036 -0.912516699223421 4.645123225149134 2.174706945726962 -0.715487563454784 -3.6482043628432805 -1.6854477360213729 1.7776925204310006 -3.9131302669633414 -2.383556179441816 -0.5258271188675252 -0.8036667317588441 0.7086862448318584 -2.230624142052203 0.41406097348380677 -0.6130073400650253 -1.3632675045058278 0.9735595012675673 0.12160033253537894 0.21468630664003407 -2.5913288107245944 -2.4297597425520236 0.24811917715025775 1.3045241300421657], :name \"data\", :type \"scatter\", :mode \"markers\"} {:x [1.276625082946955 0.33821252571199106 -0.015154685812588078 1.1514083591093647 0.08466683818920859 -2.2940118233337805 -1.8944399920130037 1.8734083964028856 0.4963401000269245 -0.7295412002016103 0.5687575978167342 -0.16940902059324436 -0.10505190979435611 2.305262699895484 0.10257559413383478 -1.5694211105091342 0.10218547957102328 0.888606832823486 1.4475086743774093 -1.3371888432529913 1.4692173371481818 -0.7003986003206867 -0.058559318415373596 -1.3648237093564568 -2.058039644016675 -0.5115824370088862 -0.6194736912359307 -0.4866026307190939 0.5918494637069253 0.8942656451531616 0.004037802992271605 2.4410428860614917 -1.0036859638676396 1.5650519942107861 -0.6344539503942214 1.0530857578471275 -0.25507191386058 0.19390656841366768 0.9799702148783344 0.40250697920909384 -1.1246971842241689 1.1558893002621817 -0.2598297816729015 -0.7543045709802693 -1.1456389337606994 0.36031431036796574 1.3322765677197304 1.059456214303732 -0.3777026473119536 -0.835753015253447 0.38144213707401936 0.048410292669787205 -1.7731006481549278 0.5563901142952982 -1.4970497668541969 -0.16497616012409316 1.8802183244954604 0.6211986507739176 -0.12339870888598348 -0.5283783729671574 -0.04475074191762692 -0.5291086390485218 1.011036975737482 0.7340337347452428 -0.2515414198608963 -0.12163432177108391 -0.6002519570674462 -0.7172953970194849 0.5705049486596846 0.8891589085198801 -0.9135875281291574 0.012926728618433074 -0.21844479534120342 -0.3331469686539879 0.04431227732881454 0.6202560939858444 -0.9807294326975756 -0.4402478255364501 1.8634242382949744 1.3807998538239252 -0.6020789172088682 -2.3012151777421095 -0.9263358579439309 0.6724700624264194 -1.638047256658234 -0.5464231359433663 0.6002413440481827 -0.008797953573587135 0.1861795503765656 -1.1200580223175471 0.005043983670935883 -0.4658959083695195 -0.958549809495067 0.2863623507439862 -0.34617984632225673 -0.36298875265086733 -0.9891869177283821 -1.1118542994126885 0.15181671349921114 0.24794119424744807], :y [2.7831697524791728 0.8187090685608163 0.0789747281857372 2.521042685815871 0.28793981267708085 -4.691555265698613 -3.8550967731313763 4.032468205557269 1.1497312830336843 -1.4165127413913814 1.301329134254899 -0.24393929684974194 -0.10921495527921657 4.936506406934127 0.32542977024411124 -3.1747064593798484 0.32461310947485933 1.9708973770366314 3.140895247842341 -2.688554441224698 3.186339881106074 -1.355506000537525 -0.011887967108251254 -2.746404911731577 -4.197574164110563 -0.9602406916340909 -1.1860988447817586 -0.9079482889271366 1.3496693470001953 1.9827434614198958 0.11915203548305402 5.220746888715586 -1.9904038362748873 3.3869589100233806 -1.217458325134494 2.315215426758974 -0.4232648872811158 0.5166208479992306 2.1621562968079093 0.9533022441479274 -2.2437271564612993 2.5304230299446813 -0.4332249460894998 -1.4683520608046956 -2.287566343500949 0.8649766580835139 2.899669849366117 2.3285512577334524 -0.6799784751886746 -1.6388551783380119 0.9092053766579717 0.21204083023223486 -3.601086563459856 1.27543920455441 -3.0232052266263407 -0.23465960420091156 4.046724020758199 1.4111085547916522 -0.14762190669240696 -0.9954010862656952 0.017018727949869486 -0.9969298158149529 2.227191051313233 1.6473160570456897 -0.415874196903289 -0.14392836157548614 -1.1458603156192984 -1.3908775357360246 1.30498701586094 1.9720530851436378 -1.8017929387264693 0.13775999717350734 -0.34659015212140987 -0.5867061950022554 0.20346209803458015 1.4091354186286134 -1.9423469314785407 -0.8109097405936471 4.011567498385566 3.0012478675536394 -1.1496848502988901 -4.70663467444948 -1.8284801271210256 1.5184394633816942 -3.3183675442186638 -1.0331757591897621 1.3672368005337694 0.092281829060973 0.5004452085954472 -2.23401559505728 0.12125836107398423 -0.8646011047543151 -1.8959163957514469 0.7101665843478416 -0.6139890521851022 -0.6491765988218574 -1.96005172101887 -2.2168420278622283 0.4285104912762707 0.6297362333404805], :name \"regression\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5dsbACUEdqT41sBCq9ykzTdywTk8Wi\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dr9n8hBf8WR43KDxtiqBQgQFTExuT-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h2\" {:id \"multivariate-regression\"} [:<> \"Multivariate Regression\"]] [:p [:<> \"We've seen that our code works for the single-variable case, now let's\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"see if it can also handle multiple variables!\"]] [\"h3\" {:id \"generate-random-data-2\"} [:<> \"Generate Random Data\"]] [:p [:<> \"Once again we'll just use synthetic data.  We'll add some noise to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"a set of sample points from the plane z = 3x + 5y.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dscEm5TEbJfJYAzFYjRSpfb4dYG37\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def xy (rand-normal! (dge 100 2)))\", :nextjournal/opts {:id \"linear_regression/xy-code\", :loc {:line 155, :end-line 155, :column 1, :end-column 36}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealGEMatrix[double, mxn:100x2, layout:column, offset:0]\\n   ▥       ↓       ↓       ┓    \\n   →      -0.64    2.63         \\n   →       0.47   -1.63         \\n   →       ⁙       ⁙            \\n   →       0.79   -0.63         \\n   →      -0.27   -0.83         \\n   ┗                       ┛    \\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dsTn96DuBBFDN9n2nqdFq2oqrLzRL\"}, :nextjournal/opts {:id \"linear_regression/xy-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def xx (col xy 0))\", :nextjournal/opts {:id \"linear_regression/xx-code\", :loc {:line 156, :end-line 156, :column 1, :end-column 20}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[  -0.64    0.47    1.61    ⋯      0.79   -0.27 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dtXxGjwa3ociL8QTEGWVj4faaYYS3\"}, :nextjournal/opts {:id \"linear_regression/xx-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def yy (col xy 1))\", :nextjournal/opts {:id \"linear_regression/yy-code\", :loc {:line 157, :end-line 157, :column 1, :end-column 20}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 100, stride:1]\\n[   2.63   -1.63    1.27    ⋯     -0.63   -0.83 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dt494RHt1HBdnihUubQ972zy6GLjM\"}, :nextjournal/opts {:id \"linear_regression/yy-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value \"(def zz (xpy (xpy (ax 3 xx) (ax 5 yy)) (rand-normal! (dv 100))))\", :nextjournal/opts {:id \"linear_regression/zz-code\", :loc {:line 158, :end-line 158, :column 1, :end-column 65}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[  12.05   -7.77   10.25    ⋯     -0.81   -5.39 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dtwzBWodVnTyhvbCUXRuDVWXzXm4y\"}, :nextjournal/opts {:id \"linear_regression/zz-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Just for fun, let's throw this in to a table!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5du5gEPxHf8P1oZQrtqcF9CtSsEaCj\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/table (tc/dataset {:x (->vec xx) :y (->vec yy) :z (->vec zz)}))\", :nextjournal/opts {:id \"linear_regression/anon-expr-5drsouAWbUqRNe9mHT2RaQ5ac4u5ki-code\", :loc {:line 162, :end-line 162, :column 1, :end-column 71}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :x, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value :y, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 2], :nextjournal/value :z, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-head-viewer, :render-fn #viewer-fn (fn [header-row {:as opts, :keys [path number-col?]}] [:thead (into [:tr] (map-indexed (fn [i {:as header-cell, :nextjournal/keys [value]}] (let [title (when (or (string? value) (keyword? value) (symbol? value)) value)] [:th.pl-6.pr-2.py-1.align-bottom.font-medium.top-0.z-10.bg-white.dark:bg-slate-900.border-b.border-gray-300.dark:border-slate-700 (cond-> {:class (when (and (ifn? number-col?) (number-col? i)) \"text-right\")} title (assoc :title title)) [:div.flex.items-center (nextjournal.clerk.render/inspect-presented opts header-cell)]]))) header-row)]), :hash \"5dszDR5S2VhSEk6vkkHpb1FBgtPV99\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value [{:path [1 0 0], :nextjournal/value -0.6405898982068778, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 1], :nextjournal/value 2.6274568702427574, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 0 2], :nextjournal/value 12.046671845114439, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 1], :nextjournal/value [{:path [1 1 0], :nextjournal/value 0.4715987980042283, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 1], :nextjournal/value -1.6320200938094687, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 1 2], :nextjournal/value -7.768156791632247, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 2], :nextjournal/value [{:path [1 2 0], :nextjournal/value 1.6052704283971562, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 1], :nextjournal/value 1.2705771126739525, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 2 2], :nextjournal/value 10.250114992283894, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 3], :nextjournal/value [{:path [1 3 0], :nextjournal/value -0.06883416116447119, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 1], :nextjournal/value 0.10615807760997878, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 3 2], :nextjournal/value 1.4383114947128677, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 4], :nextjournal/value [{:path [1 4 0], :nextjournal/value -1.412458268672692, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 1], :nextjournal/value -0.31307287178976867, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 4 2], :nextjournal/value -6.51688266332574, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 5], :nextjournal/value [{:path [1 5 0], :nextjournal/value -0.3275249967105397, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 1], :nextjournal/value 1.3707204291182948, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 5 2], :nextjournal/value 7.037757021071837, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 6], :nextjournal/value [{:path [1 6 0], :nextjournal/value -0.4059391259938786, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 1], :nextjournal/value 0.13993203036145724, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 6 2], :nextjournal/value -0.9208830379285348, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 7], :nextjournal/value [{:path [1 7 0], :nextjournal/value -0.3845099074144042, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 1], :nextjournal/value -0.512768960270049, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 7 2], :nextjournal/value -4.3348432069461635, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 8], :nextjournal/value [{:path [1 8 0], :nextjournal/value -0.03880609453336658, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 1], :nextjournal/value 0.019013455148795922, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 8 2], :nextjournal/value -1.8779247675908894, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 9], :nextjournal/value [{:path [1 9 0], :nextjournal/value -0.11339647733675276, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 1], :nextjournal/value 0.6237723122056104, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 9 2], :nextjournal/value 4.113709478298643, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 10], :nextjournal/value [{:path [1 10 0], :nextjournal/value -0.09630591140592702, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 1], :nextjournal/value 2.0900082695361637, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 10 2], :nextjournal/value 9.420331181984205, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 11], :nextjournal/value [{:path [1 11 0], :nextjournal/value -1.3419415105258685, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 1], :nextjournal/value -0.27882208367391065, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 11 2], :nextjournal/value -4.727977632744943, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 12], :nextjournal/value [{:path [1 12 0], :nextjournal/value -0.05776884046457373, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 1], :nextjournal/value 0.4593112256184122, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 12 2], :nextjournal/value 1.894991416491627, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 13], :nextjournal/value [{:path [1 13 0], :nextjournal/value 0.08624064691161153, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 1], :nextjournal/value 1.2884270333473937, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 13 2], :nextjournal/value 7.674401534599998, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 14], :nextjournal/value [{:path [1 14 0], :nextjournal/value 0.3166791526610689, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 1], :nextjournal/value 0.0498123886692396, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 14 2], :nextjournal/value 1.3107324015557502, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 15], :nextjournal/value [{:path [1 15 0], :nextjournal/value 1.100064482326575, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 1], :nextjournal/value -0.47299590857619417, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 15 2], :nextjournal/value 1.760624636952845, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 16], :nextjournal/value [{:path [1 16 0], :nextjournal/value -0.5536513187518795, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 1], :nextjournal/value -0.9310699674055003, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 16 2], :nextjournal/value -6.555753172528225, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 17], :nextjournal/value [{:path [1 17 0], :nextjournal/value -0.6542735535087375, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 1], :nextjournal/value -0.4598557529363357, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 17 2], :nextjournal/value -3.985387416146958, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 18], :nextjournal/value [{:path [1 18 0], :nextjournal/value -0.3901542888720239, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 1], :nextjournal/value 0.8442199379473296, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 18 2], :nextjournal/value 3.0978455065735835, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:path [1 19], :nextjournal/value [{:path [1 19 0], :nextjournal/value -0.319745289456566, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 1], :nextjournal/value 0.33850397337019117, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}} {:path [1 19 2], :nextjournal/value 0.4237096425198187, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.tabular-nums (if (js/Number.isNaN x) \"NaN\" (str x))]), :hash \"5drbn8dyMoS2VafpDzSbLDNwKcPSF4\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-row-viewer, :render-fn #viewer-fn (fn [row {:as opts, :keys [path number-col?]}] (into [:tr.hover:bg-gray-200.dark:hover:bg-slate-700 {:class (if (even? (peek path)) \"bg-black/5 dark:bg-gray-800\" \"bg-white dark:bg-gray-900\")}] (map-indexed (fn [idx cell] [:td.pl-6.pr-2.py-1 (when (and (ifn? number-col?) (number-col? idx)) {:class \"text-right\"}) (nextjournal.clerk.render/inspect-presented opts cell)])) row)), :hash \"5dsrRozE1ifQSFLswoM3WqNuFSjTWp\"}} {:nextjournal/value {:n 20, :path [1], :total 100, :offset 20}, :nextjournal/viewer {:name nextjournal.clerk.viewer/elision-viewer, :render-fn #viewer-fn (fn [{:as fetch-opts, :keys [total offset unbounded?]} {:keys [num-cols]}] [nextjournal.clerk.render/consume-view-context :fetch-fn (fn [fetch-fn] [:tr.border-t.dark:border-slate-700 [:td.py-1.relative {:col-span num-cols, :class (if (fn? fetch-fn) \"bg-indigo-50 hover:bg-indigo-100 dark:bg-gray-800 dark:hover:bg-slate-700 cursor-pointer\" \"text-gray-400 text-slate-500\"), :on-click (fn [_] (when (fn? fetch-fn) (fetch-fn fetch-opts)))} [:span.sticky {:style {:left \"min(50vw, 50%)\"}, :class \"-translate-x-1/2\"} (- total offset) (when unbounded? \"+\") (if (fn? fetch-fn) \" more…\" \" more elided\")]]])]), :hash \"5drUHyj6Bew7ppqVaxrQbZrbNErYSX\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/table-body-viewer, :page-size 20, :render-fn #viewer-fn (fn [rows opts] (into [:tbody] (map-indexed (fn [idx row] (nextjournal.clerk.render/inspect-presented (update opts :path conj idx) row))) rows)), :hash \"5dt4ysvbhnCYY7GiXxiZuSL8MN8TVv\"}}], :nextjournal/width :wide, :nextjournal/opts {:num-cols 3, :number-col? #{0 1 2}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/table-markup-viewer, :render-fn #viewer-fn (fn [head+body opts] [:div (into [nextjournal.clerk.render/render-table-with-sticky-header] (nextjournal.clerk.render/inspect-children opts) head+body)]), :hash \"5dr1LyqxYnX13V68FDhw2cWLsZEBsm\"}}, :nextjournal/blob-id \"5dsL9JAzeWfz2RS1p97M1BMGXRwsHH\"}, :nextjournal/width :wide, :nextjournal/opts {:id \"linear_regression/anon-expr-5drsouAWbUqRNe9mHT2RaQ5ac4u5ki-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"And let's take a look at our data.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtAVASfFNvyCMM4N4Av7pr8nPTk94\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec xx)\\n                       :y (->vec yy)\\n                       :z (->vec zz)\\n                       :type \\\"scatter3d\\\"\\n                       :mode \\\"markers\\\"\\n                       :marker {:size 2}}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dt339xQNjB33z5v8zMC9kxyyPzaLf-code\", :loc {:line 166, :end-line 171, :column 1, :end-column 45}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [-0.6405898982068778 0.4715987980042283 1.6052704283971562 -0.06883416116447119 -1.412458268672692 -0.3275249967105397 -0.4059391259938786 -0.3845099074144042 -0.03880609453336658 -0.11339647733675276 -0.09630591140592702 -1.3419415105258685 -0.05776884046457373 0.08624064691161153 0.3166791526610689 1.100064482326575 -0.5536513187518795 -0.6542735535087375 -0.3901542888720239 -0.319745289456566 0.5030217452207525 -1.0092969080300258 -0.3922147766263328 0.9304827918683687 -4.6239386514236147E-4 0.28129759550123556 -0.2089870634435319 -0.3870398743824076 1.5026969578519076 -1.1883755818817763 -0.17722168245593475 0.9469916839991968 0.8907620709842136 -0.3824523274838625 -0.2852457936086372 0.30283159981878793 0.2838174163102668 -0.593042530008055 0.8976155717680513 0.6218010549866629 -0.7617909326822864 1.2558309647527792 -1.3220030511116956 -0.1678670763123069 0.8749408705763596 -0.793260385278685 1.0135682477647838 -0.6905274710744441 -1.0704874458160387 -0.7087781310035647 -0.6392430311121172 -2.338560717097804 1.43167644763481 0.24194891536146496 -1.188220980359727 0.9787347152142899 0.494405639033013 1.3618128463480483 -0.5731790272885507 0.7676361660973786 -1.3544207300720807 0.5590852960646198 -0.27910680893659506 -1.3256330573846564 -0.6174709617684231 1.101512831202858 -1.3192873463876413 1.032912315033211 -0.40255891241395975 1.4241821140667228 0.8275130736564457 -1.1266053616798968 -0.031853214634521926 0.5585328212403932 -1.3797570034347437 0.8787533274905424 0.02239382400713917 -0.32046915002028287 1.2425134759711949 0.40814219840592764 -0.39594051986548484 0.3548031274096855 -0.6307166745566364 -0.47116695228784045 -0.038904549070664214 -0.2494543726397065 2.2293230075048767 -0.006946790622000243 1.5089721335377289 -1.042907433830152 0.631816982429813 1.3404321206726175 -0.2065973269969711 -1.0899650129763412 -0.5593689901006618 0.2726324119397294 -0.5371998888560546 1.1765827880726305 0.7883690419098556 -0.2660018607340228], :y [2.6274568702427574 -1.6320200938094687 1.2705771126739525 0.10615807760997878 -0.31307287178976867 1.3707204291182948 0.13993203036145724 -0.512768960270049 0.019013455148795922 0.6237723122056104 2.0900082695361637 -0.27882208367391065 0.4593112256184122 1.2884270333473937 0.0498123886692396 -0.47299590857619417 -0.9310699674055003 -0.4598557529363357 0.8442199379473296 0.33850397337019117 3.2988137835967373 -0.9060375539699237 0.8686075015162185 1.1772884721766572 0.04827477404233528 0.1916148712829782 -0.2334574234825468 -0.32495520009200346 -0.36904505834528306 0.6121063131113129 -0.2043729446632656 0.2807375816912698 1.7483065043587283 -0.519181319910905 1.7167387791552373 0.649734406381003 1.0761970042081068 0.042319114648884035 1.8074723415529226 1.648001320763197 -1.1437813091252835 0.5273868068643888 -0.2671093473347826 -1.0392167902454044 1.9117374062113284 -0.8413867042608179 -0.011153248068651738 0.17244657775205174 -0.026433033936049424 -0.875873456823032 0.11850331397554395 -0.27820950035318925 -0.16409463420917755 -0.8967912123975325 -1.1632466554928897 -0.2698864182380293 -0.9852232901207196 1.811536568941518 1.8982009140015073 -0.1883620353163122 -0.6886824756751329 -1.0149354205867844 0.46246912438909843 0.5248298931534463 -1.3859768244392772 1.1245865949946008 0.3786098542558199 1.575698150242002 -0.2054649685099712 0.8115253447721087 -0.2998688734201726 -1.085936311618859 -1.35006518599658 -0.898086436774079 -1.620252741955967 2.8177362374041826 -0.8237760911251866 0.46105169501051385 1.6298346711238316 1.3970836506617879 -0.9298962975325159 -1.1697879483143934 0.16871677526637344 -2.257446793753667 -0.5320085045737466 -0.023796660694457804 0.8426508451496513 -2.2177617563657734 -0.7713742000764446 -0.14575567008675355 0.8666577275934134 1.7112642303740997 1.5257346285703426 -0.31543226700905486 0.15159417424710725 0.6004874866128113 -0.6089583788583954 -1.023397268328463 -0.6296867555673233 -0.8334700814211087], :z [12.046671845114439 -7.768156791632247 10.250114992283894 1.4383114947128677 -6.51688266332574 7.037757021071837 -0.9208830379285348 -4.3348432069461635 -1.8779247675908894 4.113709478298643 9.420331181984205 -4.727977632744943 1.894991416491627 7.674401534599998 1.3107324015557502 1.760624636952845 -6.555753172528225 -3.985387416146958 3.0978455065735835 0.4237096425198187 18.386292890219977 -8.038360705115268 3.2963508902385903 8.720155592676306 0.7972692347356432 1.1819110623154923 -0.23680912130202847 -2.5607777982910465 -0.22432789593879487 0.4381105474011342 -2.528384574122058 3.1855052435151996 11.558481081076776 -3.081178169757631 9.174204319245774 5.679702161958966 6.34573197859222 -1.1270365574334733 12.611151001967762 11.199887010573313 -8.680028058591553 6.751160748004273 -5.786784257972605 -5.814673744047549 12.43551977197038 -6.5786264681362665 0.7922264443729312 -2.3173191909173596 -3.370445871224398 -5.952671233319623 -1.0808364417865723 -7.2821375459877595 4.004558171181726 -2.9881581217529773 -9.149996849939296 1.66142888012269 -3.72030757610274 13.007622173575376 8.18034299679038 3.9281227293474976 -6.812178881071786 -3.9809522396962223 2.228109873046326 -1.6069460738123815 -10.204964098791798 7.539607217584918 -1.590597354340054 11.355927439054849 -3.5453701980178156 9.798605805264925 0.6755747718466563 -7.9877845975155966 -8.055669152958242 -4.327005342407315 -11.45525778828549 15.797660524564503 -3.8454148025114496 1.2465768414716973 10.875708175507285 8.77699828376877 -5.107638624096345 -4.454166289834163 -0.5565744869909517 -11.538004851729923 -1.3629015324013543 1.207112226896566 11.217203150060383 -9.486772721244087 0.575815293637759 -5.599584006790437 7.243507020337193 12.369517788482934 7.039326095495423 -3.591952505554022 0.7463488737624213 4.896418362953045 -3.2401003336914833 0.5297676578976325 -0.8100474388612939 -5.393108438352207], :type \"scatter3d\", :mode \"markers\", :marker {:size 2}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drMJhKTyV4KcZdevCjD6sxeQehGA7\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dt339xQNjB33z5v8zMC9kxyyPzaLf-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h3\" {:id \"initialize-random-parameters-2\"} [:<> \"Initialize Random Parameters\"]] [:p [:<> \"Just like in the univariate case, we'll start with a random model and\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"use gradient descent to train it.  So let's initialize the parameters\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"randomly.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtfB7ygRcLoWqwu1PGNMAKN9i53cP\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_init_3d\\n  {:weights (rand-normal! (dv 2))\\n   :bias (entry (rand-normal! (dv 1)) 0)})\", :nextjournal/opts {:id \"linear_regression/params_init_3d-code\", :loc {:line 178, :end-line 180, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value 1.0335052289940692, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[  -0.44    0.21 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5duGLzeLuq7xDmTVxxNkwQwqyWozDt\"}, :nextjournal/opts {:id \"linear_regression/params_init_3d-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Computing the model...\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5drukE2s6axMdwFRUVJmKPDzwtDsay\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def zzhat_rdm (linear_regression params_init_3d xy))\", :nextjournal/opts {:id \"linear_regression/zzhat_rdm-code\", :loc {:line 184, :end-line 184, :column 1, :end-column 54}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[   1.87    0.48    0.60    ⋯      0.56    0.97 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5dr5VsdEFWVYMcJqtNvm3tr2ddn67o\"}, :nextjournal/opts {:id \"linear_regression/zzhat_rdm-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"... should yield a poor R-squared.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dsVauKi7QnHHfkSHcDgwfsV3VGG8Y\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(r2 zzhat_rdm zz)\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dr872BeBit2SLqpCooEL8RiBtt7Tx-code\", :loc {:line 187, :end-line 187, :column 1, :end-column 18}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value -0.4732770594289626, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}, :nextjournal/blob-id \"5dtRtHhXf8ibXRsQ1n2t1L9yKYLLDe\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dr872BeBit2SLqpCooEL8RiBtt7Tx-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Let's take a look at how poorly this model fits the data.\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5drSZGavr273d7ukyhDXbuHhbDWsyq\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec xx)\\n                       :y (->vec yy)\\n                       :z (->vec zz)\\n                       :type \\\"scatter3d\\\"\\n                       :mode \\\"markers\\\"\\n                       :marker {:size 2}}\\n                      {:x (->vec xx)\\n                       :y (->vec yy)\\n                       :z (->vec zzhat_rdm)\\n                       :type \\\"mesh3d\\\"}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dsXcArecuCrPgopwkrdB5osRxLcaY-code\", :loc {:line 191, :end-line 200, :column 1, :end-column 42}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [-0.6405898982068778 0.4715987980042283 1.6052704283971562 -0.06883416116447119 -1.412458268672692 -0.3275249967105397 -0.4059391259938786 -0.3845099074144042 -0.03880609453336658 -0.11339647733675276 -0.09630591140592702 -1.3419415105258685 -0.05776884046457373 0.08624064691161153 0.3166791526610689 1.100064482326575 -0.5536513187518795 -0.6542735535087375 -0.3901542888720239 -0.319745289456566 0.5030217452207525 -1.0092969080300258 -0.3922147766263328 0.9304827918683687 -4.6239386514236147E-4 0.28129759550123556 -0.2089870634435319 -0.3870398743824076 1.5026969578519076 -1.1883755818817763 -0.17722168245593475 0.9469916839991968 0.8907620709842136 -0.3824523274838625 -0.2852457936086372 0.30283159981878793 0.2838174163102668 -0.593042530008055 0.8976155717680513 0.6218010549866629 -0.7617909326822864 1.2558309647527792 -1.3220030511116956 -0.1678670763123069 0.8749408705763596 -0.793260385278685 1.0135682477647838 -0.6905274710744441 -1.0704874458160387 -0.7087781310035647 -0.6392430311121172 -2.338560717097804 1.43167644763481 0.24194891536146496 -1.188220980359727 0.9787347152142899 0.494405639033013 1.3618128463480483 -0.5731790272885507 0.7676361660973786 -1.3544207300720807 0.5590852960646198 -0.27910680893659506 -1.3256330573846564 -0.6174709617684231 1.101512831202858 -1.3192873463876413 1.032912315033211 -0.40255891241395975 1.4241821140667228 0.8275130736564457 -1.1266053616798968 -0.031853214634521926 0.5585328212403932 -1.3797570034347437 0.8787533274905424 0.02239382400713917 -0.32046915002028287 1.2425134759711949 0.40814219840592764 -0.39594051986548484 0.3548031274096855 -0.6307166745566364 -0.47116695228784045 -0.038904549070664214 -0.2494543726397065 2.2293230075048767 -0.006946790622000243 1.5089721335377289 -1.042907433830152 0.631816982429813 1.3404321206726175 -0.2065973269969711 -1.0899650129763412 -0.5593689901006618 0.2726324119397294 -0.5371998888560546 1.1765827880726305 0.7883690419098556 -0.2660018607340228], :y [2.6274568702427574 -1.6320200938094687 1.2705771126739525 0.10615807760997878 -0.31307287178976867 1.3707204291182948 0.13993203036145724 -0.512768960270049 0.019013455148795922 0.6237723122056104 2.0900082695361637 -0.27882208367391065 0.4593112256184122 1.2884270333473937 0.0498123886692396 -0.47299590857619417 -0.9310699674055003 -0.4598557529363357 0.8442199379473296 0.33850397337019117 3.2988137835967373 -0.9060375539699237 0.8686075015162185 1.1772884721766572 0.04827477404233528 0.1916148712829782 -0.2334574234825468 -0.32495520009200346 -0.36904505834528306 0.6121063131113129 -0.2043729446632656 0.2807375816912698 1.7483065043587283 -0.519181319910905 1.7167387791552373 0.649734406381003 1.0761970042081068 0.042319114648884035 1.8074723415529226 1.648001320763197 -1.1437813091252835 0.5273868068643888 -0.2671093473347826 -1.0392167902454044 1.9117374062113284 -0.8413867042608179 -0.011153248068651738 0.17244657775205174 -0.026433033936049424 -0.875873456823032 0.11850331397554395 -0.27820950035318925 -0.16409463420917755 -0.8967912123975325 -1.1632466554928897 -0.2698864182380293 -0.9852232901207196 1.811536568941518 1.8982009140015073 -0.1883620353163122 -0.6886824756751329 -1.0149354205867844 0.46246912438909843 0.5248298931534463 -1.3859768244392772 1.1245865949946008 0.3786098542558199 1.575698150242002 -0.2054649685099712 0.8115253447721087 -0.2998688734201726 -1.085936311618859 -1.35006518599658 -0.898086436774079 -1.620252741955967 2.8177362374041826 -0.8237760911251866 0.46105169501051385 1.6298346711238316 1.3970836506617879 -0.9298962975325159 -1.1697879483143934 0.16871677526637344 -2.257446793753667 -0.5320085045737466 -0.023796660694457804 0.8426508451496513 -2.2177617563657734 -0.7713742000764446 -0.14575567008675355 0.8666577275934134 1.7112642303740997 1.5257346285703426 -0.31543226700905486 0.15159417424710725 0.6004874866128113 -0.6089583788583954 -1.023397268328463 -0.6296867555673233 -0.8334700814211087], :z [12.046671845114439 -7.768156791632247 10.250114992283894 1.4383114947128677 -6.51688266332574 7.037757021071837 -0.9208830379285348 -4.3348432069461635 -1.8779247675908894 4.113709478298643 9.420331181984205 -4.727977632744943 1.894991416491627 7.674401534599998 1.3107324015557502 1.760624636952845 -6.555753172528225 -3.985387416146958 3.0978455065735835 0.4237096425198187 18.386292890219977 -8.038360705115268 3.2963508902385903 8.720155592676306 0.7972692347356432 1.1819110623154923 -0.23680912130202847 -2.5607777982910465 -0.22432789593879487 0.4381105474011342 -2.528384574122058 3.1855052435151996 11.558481081076776 -3.081178169757631 9.174204319245774 5.679702161958966 6.34573197859222 -1.1270365574334733 12.611151001967762 11.199887010573313 -8.680028058591553 6.751160748004273 -5.786784257972605 -5.814673744047549 12.43551977197038 -6.5786264681362665 0.7922264443729312 -2.3173191909173596 -3.370445871224398 -5.952671233319623 -1.0808364417865723 -7.2821375459877595 4.004558171181726 -2.9881581217529773 -9.149996849939296 1.66142888012269 -3.72030757610274 13.007622173575376 8.18034299679038 3.9281227293474976 -6.812178881071786 -3.9809522396962223 2.228109873046326 -1.6069460738123815 -10.204964098791798 7.539607217584918 -1.590597354340054 11.355927439054849 -3.5453701980178156 9.798605805264925 0.6755747718466563 -7.9877845975155966 -8.055669152958242 -4.327005342407315 -11.45525778828549 15.797660524564503 -3.8454148025114496 1.2465768414716973 10.875708175507285 8.77699828376877 -5.107638624096345 -4.454166289834163 -0.5565744869909517 -11.538004851729923 -1.3629015324013543 1.207112226896566 11.217203150060383 -9.486772721244087 0.575815293637759 -5.599584006790437 7.243507020337193 12.369517788482934 7.039326095495423 -3.591952505554022 0.7463488737624213 4.896418362953045 -3.2401003336914833 0.5297676578976325 -0.8100474388612939 -5.393108438352207], :type \"scatter3d\", :mode \"markers\", :marker {:size 2}} {:x [-0.6405898982068778 0.4715987980042283 1.6052704283971562 -0.06883416116447119 -1.412458268672692 -0.3275249967105397 -0.4059391259938786 -0.3845099074144042 -0.03880609453336658 -0.11339647733675276 -0.09630591140592702 -1.3419415105258685 -0.05776884046457373 0.08624064691161153 0.3166791526610689 1.100064482326575 -0.5536513187518795 -0.6542735535087375 -0.3901542888720239 -0.319745289456566 0.5030217452207525 -1.0092969080300258 -0.3922147766263328 0.9304827918683687 -4.6239386514236147E-4 0.28129759550123556 -0.2089870634435319 -0.3870398743824076 1.5026969578519076 -1.1883755818817763 -0.17722168245593475 0.9469916839991968 0.8907620709842136 -0.3824523274838625 -0.2852457936086372 0.30283159981878793 0.2838174163102668 -0.593042530008055 0.8976155717680513 0.6218010549866629 -0.7617909326822864 1.2558309647527792 -1.3220030511116956 -0.1678670763123069 0.8749408705763596 -0.793260385278685 1.0135682477647838 -0.6905274710744441 -1.0704874458160387 -0.7087781310035647 -0.6392430311121172 -2.338560717097804 1.43167644763481 0.24194891536146496 -1.188220980359727 0.9787347152142899 0.494405639033013 1.3618128463480483 -0.5731790272885507 0.7676361660973786 -1.3544207300720807 0.5590852960646198 -0.27910680893659506 -1.3256330573846564 -0.6174709617684231 1.101512831202858 -1.3192873463876413 1.032912315033211 -0.40255891241395975 1.4241821140667228 0.8275130736564457 -1.1266053616798968 -0.031853214634521926 0.5585328212403932 -1.3797570034347437 0.8787533274905424 0.02239382400713917 -0.32046915002028287 1.2425134759711949 0.40814219840592764 -0.39594051986548484 0.3548031274096855 -0.6307166745566364 -0.47116695228784045 -0.038904549070664214 -0.2494543726397065 2.2293230075048767 -0.006946790622000243 1.5089721335377289 -1.042907433830152 0.631816982429813 1.3404321206726175 -0.2065973269969711 -1.0899650129763412 -0.5593689901006618 0.2726324119397294 -0.5371998888560546 1.1765827880726305 0.7883690419098556 -0.2660018607340228], :y [2.6274568702427574 -1.6320200938094687 1.2705771126739525 0.10615807760997878 -0.31307287178976867 1.3707204291182948 0.13993203036145724 -0.512768960270049 0.019013455148795922 0.6237723122056104 2.0900082695361637 -0.27882208367391065 0.4593112256184122 1.2884270333473937 0.0498123886692396 -0.47299590857619417 -0.9310699674055003 -0.4598557529363357 0.8442199379473296 0.33850397337019117 3.2988137835967373 -0.9060375539699237 0.8686075015162185 1.1772884721766572 0.04827477404233528 0.1916148712829782 -0.2334574234825468 -0.32495520009200346 -0.36904505834528306 0.6121063131113129 -0.2043729446632656 0.2807375816912698 1.7483065043587283 -0.519181319910905 1.7167387791552373 0.649734406381003 1.0761970042081068 0.042319114648884035 1.8074723415529226 1.648001320763197 -1.1437813091252835 0.5273868068643888 -0.2671093473347826 -1.0392167902454044 1.9117374062113284 -0.8413867042608179 -0.011153248068651738 0.17244657775205174 -0.026433033936049424 -0.875873456823032 0.11850331397554395 -0.27820950035318925 -0.16409463420917755 -0.8967912123975325 -1.1632466554928897 -0.2698864182380293 -0.9852232901207196 1.811536568941518 1.8982009140015073 -0.1883620353163122 -0.6886824756751329 -1.0149354205867844 0.46246912438909843 0.5248298931534463 -1.3859768244392772 1.1245865949946008 0.3786098542558199 1.575698150242002 -0.2054649685099712 0.8115253447721087 -0.2998688734201726 -1.085936311618859 -1.35006518599658 -0.898086436774079 -1.620252741955967 2.8177362374041826 -0.8237760911251866 0.46105169501051385 1.6298346711238316 1.3970836506617879 -0.9298962975325159 -1.1697879483143934 0.16871677526637344 -2.257446793753667 -0.5320085045737466 -0.023796660694457804 0.8426508451496513 -2.2177617563657734 -0.7713742000764446 -0.14575567008675355 0.8666577275934134 1.7112642303740997 1.5257346285703426 -0.31543226700905486 0.15159417424710725 0.6004874866128113 -0.6089583788583954 -1.023397268328463 -0.6296867555673233 -0.8334700814211087], :z [1.8697498369610634 0.4818768725598098 0.6011506549006365 1.0860594700947557 1.584360858195616 1.4668543362627116 1.240502649034552 1.0929333887061425 1.0544868305356552 1.2151323614343368 1.5181330740941172 1.5608023114589904 1.1560030943169155 1.2686419576485528 0.9056857158191982 0.4526981010150595 1.0782634250714815 1.22200567831433 1.3827351944162367 1.2448884769715443 1.5122265660478922 1.2826497371307701 1.3887994303977034 0.876233098406572 1.0439292048283642 0.9511709909777851 1.0753847808154426 1.1338074329865844 0.29878643785461956 1.6823541723564448 1.0676639839406061 0.6791796885013548 1.0144985316861372 1.090676582594024 1.5216488802594834 1.0387666259922477 1.137375835988606 1.3015849386298401 1.0240320921342412 1.1107769006406756 1.1241655785129208 0.596464874518511 1.554570687501121 0.8868026630969662 1.056016983940316 1.201946109790728 0.5882838829091708 1.37173299976652 1.4956376479625462 1.1577307707793116 1.3379030064887725 1.9963861578453228 0.37321474759473083 0.7378991275785187 1.3063645280842229 0.5487182917412312 0.6088678314425757 0.8220703488965606 1.6858796227489032 0.6582162367563575 1.4794689891806503 0.5743158694761588 1.2533812519487166 1.7238459163124906 1.0098239780241334 0.7903453609860009 1.690111916033657 0.9158396854491639 1.1658896443142701 0.5830718978621283 0.6084431269728584 1.2958128130118025 0.7615533584102596 0.5992994497651881 1.2932838649009561 1.2461919142947755 0.8492902071561539 1.2711536202322624 0.8357215127356903 1.1510005854343461 1.009603157915434 0.63078389820916 1.3448100231408306 0.7613697769031093 0.9378537098478934 1.1374608310299503 0.23787130173183313 0.5669405615868353 0.21085343761211317 1.4583211069845898 0.9409550381506784 0.8101800921798267 1.446840731077114 1.4429538675857128 1.310010360989205 1.041533808233273 1.139280794896873 0.3027201278654348 0.5557090963384864 0.9732466574619414], :type \"mesh3d\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5drckWbvzsYanwJqhEeyunWABwJ6TQ\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dsXcArecuCrPgopwkrdB5osRxLcaY-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [\"h2\" {:id \"train-the-model-2\"} [:<> \"Train the Model\"]] [:p [:<> \"Now let's whip those parameters into shape!  We'll go with the same\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"hyperparameters as we did earlier.  Hopefully this yields a bias close\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"to 0 and weights close to [3, 5].\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtYwEJptRLyW1odhJLz3i4pcJWHAp\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def params_optimal_3d (train params_init_3d xy zz 0.0001 1000))\", :nextjournal/opts {:id \"linear_regression/params_optimal_3d-code\", :loc {:line 208, :end-line 208, :column 1, :end-column 65}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value [{:path [0 0], :nextjournal/value :bias, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [0 1], :nextjournal/value 0.15956032344571194, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}} {:path [1], :nextjournal/value [{:path [1 0], :nextjournal/value :weights, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-atom.inspected-value (str x)]), :hash \"5dqsxufLQpt4pGWN1YE57zKzYERSTe\"}} {:path [1 1], :nextjournal/value \"#RealBlockVector[double, n:2, offset: 0, stride:1]\\n[   2.83    5.07 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-entry-viewer, :render-fn #viewer-fn (fn [xs opts] (into [:<>] (comp (nextjournal.clerk.render/inspect-children opts) (interpose \" \")) xs)), :page-size 2, :hash \"5drNZ9ic4iU25Gs7bWK3UXt6PMEyLs\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/map-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-map, :opening-paren \"{\", :closing-paren (\"}\"), :page-size 10, :hash \"5drc3ac5ux7kS4h2vozdxwsrKDqSmn\"}}, :nextjournal/blob-id \"5dt3vq6auR8jdeix6Y7jwasVQdkoNw\"}, :nextjournal/opts {:id \"linear_regression/params_optimal_3d-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"Building our optimal model...\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtSAuugjGHwsLDwY6FVrGHzjf1PLr\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(def zzhat (linear_regression params_optimal_3d xy))\", :nextjournal/opts {:id \"linear_regression/zzhat-code\", :loc {:line 212, :end-line 212, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#RealBlockVector[double, n:100, offset: 0, stride:1]\\n[  11.67   -6.78   11.15    ⋯     -0.80   -4.82 ]\\n\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5dsf7jSy6a6UgswfHcqnAt4QKhUbgG\"}}, :nextjournal/blob-id \"5duEMtbbyWswF79wikR64Ek1pFPTdA\"}, :nextjournal/opts {:id \"linear_regression/zzhat-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"... yields a great R-squared!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtPoi2snszdtWUQMtX8NyKj8kxjki\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(r2 zzhat zz)\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dsVxexkqoiGeTheDg272TPtJwfX9c-code\", :loc {:line 216, :end-line 216, :column 1, :end-column 14}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value 0.9638994200236929, :nextjournal/viewer {:render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5dr5kWRtr7mCj9ikbmX2S4HCkE4Xxt\"}}, :nextjournal/blob-id \"5drZt5FupYpHV6YGVaeTQZWDvdTq28\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dsVxexkqoiGeTheDg272TPtJwfX9c-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:nextjournal/value [:div.markdown-viewer [:p [:<> \"And to cap this notebook off, let's take a look at our beautiful 3D model!\"]]], :nextjournal/opts {:id \"linear_regression/markdown-5dtYWQobg9ucVdPRcyLuo1SPh78F4m\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer-, :render-fn #viewer-fn identity, :hash \"5du1K91pV2nRmpCG3vM8fBcDsgHWKs\"}} {:nextjournal/value \"(clerk/plotly {:data [{:x (->vec xx)\\n                       :y (->vec yy)\\n                       :z (->vec zz)\\n                       :type \\\"scatter3d\\\"\\n                       :mode \\\"markers\\\"\\n                       :marker {:size 2}}\\n                      {:x (->vec xx)\\n                       :y (->vec yy)\\n                       :z (->vec zzhat)\\n                       :type \\\"mesh3d\\\"}]})\", :nextjournal/opts {:id \"linear_regression/anon-expr-5dtrPzv7RxV49ZBkVzXHQyJAorKWws-code\", :loc {:line 220, :end-line 229, :column 1, :end-column 42}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value {:data [{:x [-0.6405898982068778 0.4715987980042283 1.6052704283971562 -0.06883416116447119 -1.412458268672692 -0.3275249967105397 -0.4059391259938786 -0.3845099074144042 -0.03880609453336658 -0.11339647733675276 -0.09630591140592702 -1.3419415105258685 -0.05776884046457373 0.08624064691161153 0.3166791526610689 1.100064482326575 -0.5536513187518795 -0.6542735535087375 -0.3901542888720239 -0.319745289456566 0.5030217452207525 -1.0092969080300258 -0.3922147766263328 0.9304827918683687 -4.6239386514236147E-4 0.28129759550123556 -0.2089870634435319 -0.3870398743824076 1.5026969578519076 -1.1883755818817763 -0.17722168245593475 0.9469916839991968 0.8907620709842136 -0.3824523274838625 -0.2852457936086372 0.30283159981878793 0.2838174163102668 -0.593042530008055 0.8976155717680513 0.6218010549866629 -0.7617909326822864 1.2558309647527792 -1.3220030511116956 -0.1678670763123069 0.8749408705763596 -0.793260385278685 1.0135682477647838 -0.6905274710744441 -1.0704874458160387 -0.7087781310035647 -0.6392430311121172 -2.338560717097804 1.43167644763481 0.24194891536146496 -1.188220980359727 0.9787347152142899 0.494405639033013 1.3618128463480483 -0.5731790272885507 0.7676361660973786 -1.3544207300720807 0.5590852960646198 -0.27910680893659506 -1.3256330573846564 -0.6174709617684231 1.101512831202858 -1.3192873463876413 1.032912315033211 -0.40255891241395975 1.4241821140667228 0.8275130736564457 -1.1266053616798968 -0.031853214634521926 0.5585328212403932 -1.3797570034347437 0.8787533274905424 0.02239382400713917 -0.32046915002028287 1.2425134759711949 0.40814219840592764 -0.39594051986548484 0.3548031274096855 -0.6307166745566364 -0.47116695228784045 -0.038904549070664214 -0.2494543726397065 2.2293230075048767 -0.006946790622000243 1.5089721335377289 -1.042907433830152 0.631816982429813 1.3404321206726175 -0.2065973269969711 -1.0899650129763412 -0.5593689901006618 0.2726324119397294 -0.5371998888560546 1.1765827880726305 0.7883690419098556 -0.2660018607340228], :y [2.6274568702427574 -1.6320200938094687 1.2705771126739525 0.10615807760997878 -0.31307287178976867 1.3707204291182948 0.13993203036145724 -0.512768960270049 0.019013455148795922 0.6237723122056104 2.0900082695361637 -0.27882208367391065 0.4593112256184122 1.2884270333473937 0.0498123886692396 -0.47299590857619417 -0.9310699674055003 -0.4598557529363357 0.8442199379473296 0.33850397337019117 3.2988137835967373 -0.9060375539699237 0.8686075015162185 1.1772884721766572 0.04827477404233528 0.1916148712829782 -0.2334574234825468 -0.32495520009200346 -0.36904505834528306 0.6121063131113129 -0.2043729446632656 0.2807375816912698 1.7483065043587283 -0.519181319910905 1.7167387791552373 0.649734406381003 1.0761970042081068 0.042319114648884035 1.8074723415529226 1.648001320763197 -1.1437813091252835 0.5273868068643888 -0.2671093473347826 -1.0392167902454044 1.9117374062113284 -0.8413867042608179 -0.011153248068651738 0.17244657775205174 -0.026433033936049424 -0.875873456823032 0.11850331397554395 -0.27820950035318925 -0.16409463420917755 -0.8967912123975325 -1.1632466554928897 -0.2698864182380293 -0.9852232901207196 1.811536568941518 1.8982009140015073 -0.1883620353163122 -0.6886824756751329 -1.0149354205867844 0.46246912438909843 0.5248298931534463 -1.3859768244392772 1.1245865949946008 0.3786098542558199 1.575698150242002 -0.2054649685099712 0.8115253447721087 -0.2998688734201726 -1.085936311618859 -1.35006518599658 -0.898086436774079 -1.620252741955967 2.8177362374041826 -0.8237760911251866 0.46105169501051385 1.6298346711238316 1.3970836506617879 -0.9298962975325159 -1.1697879483143934 0.16871677526637344 -2.257446793753667 -0.5320085045737466 -0.023796660694457804 0.8426508451496513 -2.2177617563657734 -0.7713742000764446 -0.14575567008675355 0.8666577275934134 1.7112642303740997 1.5257346285703426 -0.31543226700905486 0.15159417424710725 0.6004874866128113 -0.6089583788583954 -1.023397268328463 -0.6296867555673233 -0.8334700814211087], :z [12.046671845114439 -7.768156791632247 10.250114992283894 1.4383114947128677 -6.51688266332574 7.037757021071837 -0.9208830379285348 -4.3348432069461635 -1.8779247675908894 4.113709478298643 9.420331181984205 -4.727977632744943 1.894991416491627 7.674401534599998 1.3107324015557502 1.760624636952845 -6.555753172528225 -3.985387416146958 3.0978455065735835 0.4237096425198187 18.386292890219977 -8.038360705115268 3.2963508902385903 8.720155592676306 0.7972692347356432 1.1819110623154923 -0.23680912130202847 -2.5607777982910465 -0.22432789593879487 0.4381105474011342 -2.528384574122058 3.1855052435151996 11.558481081076776 -3.081178169757631 9.174204319245774 5.679702161958966 6.34573197859222 -1.1270365574334733 12.611151001967762 11.199887010573313 -8.680028058591553 6.751160748004273 -5.786784257972605 -5.814673744047549 12.43551977197038 -6.5786264681362665 0.7922264443729312 -2.3173191909173596 -3.370445871224398 -5.952671233319623 -1.0808364417865723 -7.2821375459877595 4.004558171181726 -2.9881581217529773 -9.149996849939296 1.66142888012269 -3.72030757610274 13.007622173575376 8.18034299679038 3.9281227293474976 -6.812178881071786 -3.9809522396962223 2.228109873046326 -1.6069460738123815 -10.204964098791798 7.539607217584918 -1.590597354340054 11.355927439054849 -3.5453701980178156 9.798605805264925 0.6755747718466563 -7.9877845975155966 -8.055669152958242 -4.327005342407315 -11.45525778828549 15.797660524564503 -3.8454148025114496 1.2465768414716973 10.875708175507285 8.77699828376877 -5.107638624096345 -4.454166289834163 -0.5565744869909517 -11.538004851729923 -1.3629015324013543 1.207112226896566 11.217203150060383 -9.486772721244087 0.575815293637759 -5.599584006790437 7.243507020337193 12.369517788482934 7.039326095495423 -3.591952505554022 0.7463488737624213 4.896418362953045 -3.2401003336914833 0.5297676578976325 -0.8100474388612939 -5.393108438352207], :type \"scatter3d\", :mode \"markers\", :marker {:size 2}} {:x [-0.6405898982068778 0.4715987980042283 1.6052704283971562 -0.06883416116447119 -1.412458268672692 -0.3275249967105397 -0.4059391259938786 -0.3845099074144042 -0.03880609453336658 -0.11339647733675276 -0.09630591140592702 -1.3419415105258685 -0.05776884046457373 0.08624064691161153 0.3166791526610689 1.100064482326575 -0.5536513187518795 -0.6542735535087375 -0.3901542888720239 -0.319745289456566 0.5030217452207525 -1.0092969080300258 -0.3922147766263328 0.9304827918683687 -4.6239386514236147E-4 0.28129759550123556 -0.2089870634435319 -0.3870398743824076 1.5026969578519076 -1.1883755818817763 -0.17722168245593475 0.9469916839991968 0.8907620709842136 -0.3824523274838625 -0.2852457936086372 0.30283159981878793 0.2838174163102668 -0.593042530008055 0.8976155717680513 0.6218010549866629 -0.7617909326822864 1.2558309647527792 -1.3220030511116956 -0.1678670763123069 0.8749408705763596 -0.793260385278685 1.0135682477647838 -0.6905274710744441 -1.0704874458160387 -0.7087781310035647 -0.6392430311121172 -2.338560717097804 1.43167644763481 0.24194891536146496 -1.188220980359727 0.9787347152142899 0.494405639033013 1.3618128463480483 -0.5731790272885507 0.7676361660973786 -1.3544207300720807 0.5590852960646198 -0.27910680893659506 -1.3256330573846564 -0.6174709617684231 1.101512831202858 -1.3192873463876413 1.032912315033211 -0.40255891241395975 1.4241821140667228 0.8275130736564457 -1.1266053616798968 -0.031853214634521926 0.5585328212403932 -1.3797570034347437 0.8787533274905424 0.02239382400713917 -0.32046915002028287 1.2425134759711949 0.40814219840592764 -0.39594051986548484 0.3548031274096855 -0.6307166745566364 -0.47116695228784045 -0.038904549070664214 -0.2494543726397065 2.2293230075048767 -0.006946790622000243 1.5089721335377289 -1.042907433830152 0.631816982429813 1.3404321206726175 -0.2065973269969711 -1.0899650129763412 -0.5593689901006618 0.2726324119397294 -0.5371998888560546 1.1765827880726305 0.7883690419098556 -0.2660018607340228], :y [2.6274568702427574 -1.6320200938094687 1.2705771126739525 0.10615807760997878 -0.31307287178976867 1.3707204291182948 0.13993203036145724 -0.512768960270049 0.019013455148795922 0.6237723122056104 2.0900082695361637 -0.27882208367391065 0.4593112256184122 1.2884270333473937 0.0498123886692396 -0.47299590857619417 -0.9310699674055003 -0.4598557529363357 0.8442199379473296 0.33850397337019117 3.2988137835967373 -0.9060375539699237 0.8686075015162185 1.1772884721766572 0.04827477404233528 0.1916148712829782 -0.2334574234825468 -0.32495520009200346 -0.36904505834528306 0.6121063131113129 -0.2043729446632656 0.2807375816912698 1.7483065043587283 -0.519181319910905 1.7167387791552373 0.649734406381003 1.0761970042081068 0.042319114648884035 1.8074723415529226 1.648001320763197 -1.1437813091252835 0.5273868068643888 -0.2671093473347826 -1.0392167902454044 1.9117374062113284 -0.8413867042608179 -0.011153248068651738 0.17244657775205174 -0.026433033936049424 -0.875873456823032 0.11850331397554395 -0.27820950035318925 -0.16409463420917755 -0.8967912123975325 -1.1632466554928897 -0.2698864182380293 -0.9852232901207196 1.811536568941518 1.8982009140015073 -0.1883620353163122 -0.6886824756751329 -1.0149354205867844 0.46246912438909843 0.5248298931534463 -1.3859768244392772 1.1245865949946008 0.3786098542558199 1.575698150242002 -0.2054649685099712 0.8115253447721087 -0.2998688734201726 -1.085936311618859 -1.35006518599658 -0.898086436774079 -1.620252741955967 2.8177362374041826 -0.8237760911251866 0.46105169501051385 1.6298346711238316 1.3970836506617879 -0.9298962975325159 -1.1697879483143934 0.16871677526637344 -2.257446793753667 -0.5320085045737466 -0.023796660694457804 0.8426508451496513 -2.2177617563657734 -0.7713742000764446 -0.14575567008675355 0.8666577275934134 1.7112642303740997 1.5257346285703426 -0.31543226700905486 0.15159417424710725 0.6004874866128113 -0.6089583788583954 -1.023397268328463 -0.6296867555673233 -0.8334700814211087], :z [11.668663696862641 -6.780546905728024 11.14691001818735 0.5029618773220075 -5.426807051728501 6.182624798247583 -0.28018567487976187 -3.5290863176432183 0.14610291075869822 3.0014010776864875 10.484449090048873 -5.0534909805554005 2.3249797546638438 6.93679009895482 1.3087099062455372 0.8756662763778773 -6.128981457953126 -4.024532191168569 3.3356496452974893 0.9707178506402113 18.310587646422352 -7.292062140031252 3.4534750664576457 8.763445301189963 0.40303214827049794 1.9275591057823056 -1.6158810225376259 -2.5839250223835837 2.5426774182144722 -0.10119927266304704 -1.3784727978111513 4.264154788153563 11.546379920318993 -3.5557753228675884 8.056836897398034 4.311455697201762 6.420034609954779 -1.304860710255348 11.865788245824588 10.276300839639601 -7.796828934752449 6.389184630171927 -4.937651514938786 -5.585128002031838 12.33027634283105 -6.352609250160215 2.9725894480780286 -0.9210357374454334 -3.0052007654419346 -6.288293471403145 -1.0493642962885348 -7.87198176124752 3.3808232103321743 -3.7026900616920715 -9.102824794694794 1.562043487898404 -3.4363441554028142 13.200616936378912 8.161767043555818 1.3777635481124086 -7.167050268432506 -3.403882779630534 1.7143470320519738 -0.932340090490869 -8.616305688587664 8.980431260392912 -1.655794221383555 11.0736073355199 -2.0219776618637075 8.306561328021155 0.9818811999211763 -8.536372573466894 -6.776230440206391 -2.8129552055386418 -11.962379924600041 16.93500652681543 -3.9540587607400486 1.5900560895168194 11.94152692181344 8.399099341968773 -5.676524424733364 -4.767431630253558 -0.770613541970054 -12.620949618310755 -2.648174887437618 -0.6673498363195102 10.743875119539355 -11.105438084790457 0.5204027652788619 -3.5321516706208627 6.342795075615004 12.631645924869517 7.3110027837225795 -4.525737790132183 -0.6554376833567389 3.9762464277732534 -4.449113202902112 -1.6985497617515826 -0.8013089873178432 -4.81970966717333], :type \"mesh3d\"}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/plotly-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-plotly, :hash \"5ds4R6CLtg2dujNC6omjiceEZX6kUH\"}}, :nextjournal/blob-id \"5dqzXekXmCSyt1em8sBcMj4PWxDJkb\"}, :nextjournal/opts {:id \"linear_regression/anon-expr-5dtrPzv7RxV49ZBkVzXHQyJAorKWws-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}}], :css-class nil}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :index \"notebooks/linear_regression.clj\", :browse? false, :paths [\"notebooks/linear_regression.clj\"], :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@3nxNZCmz3EeGxdusvfUfkDbxw5u7/viewer.js?immutable=true\"}, :current-path \"notebooks/linear_regression.clj\", :bundle? false, :path->url {\"notebooks/linear_regression.clj\" \"\"}, :expanded-paths [\"notebooks/linear_regression.clj\"], :report-fn #function[nextjournal.clerk.builder/build-ui-reporter]}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
let opts = nextjournal.clerk.sci_env.read_string(state)
nextjournal.clerk.static_app.init(opts)
</script></body></html>